const dictionary = {
  en: {
    concert_name: "Concert Name",
    genre_stuff: {
      select_genre: "Select Genre",
      blues: "Blues",
      classical: "Classical",
      country: "Country",
      dance: "Dance",
      electronic: "Electronic",
      folk: "Folk",
      hiphop: "Hip-Hop",
      jazz: "Jazz",
      metal: "Metal",
      pop: "Pop",
      reggae: "Reggae",
      rock: "Rock",
      soul: "Soul",
      world: "World",
    },
    details: "Details",
    poster_url: "Poster URL",
    performer_name: "Performer Name",
    genre: "Genre",
    age_to_attend: "Age to Attend",
    date: "Date",
    doors_open: "Doors Open",
    doors_close: "Doors Close",
    disability_access: "Disability Access",
    deal: "Deal",
    venue_name: "Venue Name",
    venue_address: "Venue Address",
    city: "City",
    country: "Country",
    seats: "Seats",
    seat_type: "Seat Type",
    total_amount: "Total Amount",
    amount_to_reserve: "Amount To Reserve",
    price_per_seat: "Price Per Seat",
    tickets_available: "Tickets Available",
    create_concert: "Create Concert",
    admin_name: "Admin Name",
    create_concert_button: "CREATE CONCERT",
    update_concert_button: "UPDATE CONCERT",
    view_concert_button: "VIEW CONCERT",
    delete_concert_button: "DELETE CONCERT",
    view_requests_button: "VIEW REQUESTS",
    search_button: "SEARCH",
    enter_id_update: "Enter the ID of the Concert you wish to update",
    enter_id_view: "Enter the ID of the Concert you wish to view",
    enter_id_delete: "Enter the ID of the Concert you wish to delete",
    requests: "Requests",
    view_request_button_single: "VIEW REQUEST",
    admin_panel: "Admin Panel",
    enter_concert_id: "Enter Concert Id",
    select_venue: "Select Venue",
    time_format_error: "Time format should be in HH:MM",
    age_to_attend_error: "Age To Attend cannot be less than 0",
    enter_age: "Enter Age",
    search: "Search",
    concert_not_found: "Concert Not Found",
    cheapest_ticket: "Cheapest Ticket",
    location: "Location",
    requested_by: "Requested By",
    requested_on: "Requested On",
    accept_request: "Accept Request",
    reject_request: "Reject Request",
    no_requests_found: "No Requests Found",

    create_venue: "CREATE VENUE",
    update_venue: "UPDATE VENUE",
    view_venue: "VIEW VENUE",
    delete_venue: "DELETE VENUE",
    row: "Row",
    add_a_row: "ADD A ROW",
    remove_a_row: "REMOVE A ROW",
    add_a_new_type: "ADD A NEW SEAT TYPE",
    remove_a_new_type: "REMOVE LAST ADDED SEAT TYPE",
    venue_not_found: "Venue Not Found",
    seat_count_error: "Seat per row must be less than 30 and more than 0",
    seat_count: "Seat count",
    address: "Address",
    enter_vid_update: "Enter the ID of the Venue you wish to update",
    enter_vid_view: "Enter the ID of the Venue you wish to view",
    enter_vid_delete: "Enter the ID of the Venue you wish to delete",
    total_venue_seat_number: "Total venue seat number",
    total_seat: "Total seat",
    select_country: "Select Country",
    close: "Close",

  },
  fr: {
    concert_name: "Nom du concert",
    genre_stuff: {
      select_genre: "Sélectionnez le genre",
      blues: "Blues",
      classical: "Classique",
      country: "Country",
      dance: "Danse",
      electronic: "Électronique",
      folk: "Folk",
      hiphop: "Hip-Hop",
      jazz: "Jazz",
      metal: "Metal",
      pop: "Pop",
      reggae: "Reggae",
      rock: "Rock",
      soul: "Soul",
      world: "Du Monde",
    },
    details: "Détails",
    poster_url: "URL de l'affiche",
    performer_name: "Nom de l'artiste",
    genre: "Genre",
    age_to_attend: "Âge pour participer",
    date: "Date",
    doors_open: "Ouverture des portes",
    doors_close: "Fermeture des portes",
    disability_access: "Accessibilité handicapés",
    deal: "Offre",
    venue_name: "Nom de la salle",
    venue_address: "Adresse de la salle",
    city: "Ville",
    country: "Pays",
    seats: "Places",
    seat_type: "Type de place",
    total_amount: "Montant total",
    amount_to_reserve: "Montant à réserver",
    price_per_seat: "Prix par place",
    tickets_available: "Places disponibles",
    create_concert: "Créer un concert",
    admin_name: "Nom de l'administrateur",
    create_concert_button: "CRÉER UN CONCERT",
    update_concert_button: "METTRE À JOUR LE CONCERT",
    view_concert_button: "VOIR LE CONCERT",
    delete_concert_button: "SUPPRIMER LE CONCERT",
    view_requests_button: "VOIR LES DEMANDES",
    search_button: "RECHERCHER",
    enter_id_update:
        "Entrez l'identifiant du concert que vous souhaitez mettre à jour",
    enter_id_view: "Entrez l'identifiant du concert que vous souhaitez voir",
    enter_id_delete:
        "Entrez l'identifiant du concert que vous souhaitez supprimer",
    requests: "Demandes",
    view_request_button_single: "VOIR LA DEMANDE",
    admin_panel: "Panneau D'administration",
    enter_concert_id: "Entrez l'identifiant du concert",
    select_venue: "Choisir le lieu",
    time_format_error: "Le format de l'heure doit être en HH:MM",
    age_to_attend_error: "L'âge pour participer ne peut être inférieur à 0",
    enter_age: "Entrez l'âge",
    search: "Recherche",
    concert_not_found: "Concert non trouvé",
    cheapest_ticket: "Le billet le moins cher",
    location: "Localisation",
    requested_by: "Demandé Par",
    requested_on: "Demandé le",
    accept_request: "Accepter La Demande",
    reject_request: "Rejeter La Demande",
    no_requests_found: "Aucune Demande Trouvée",

    create_venue: "CRÉER UN LIEU",
    update_venue: "METTRE À JOUR LE LIEU",
    view_venue: "VOIR LE LIEU",
    delete_venue: "SUPPRIMER LE LIEU",
    row: "Rangée",
    add_a_row: "AJOUTER UNE RANGÉE",
    remove_a_row: "SUPPRIMER UNE RANGÉE",
    add_a_new_type: "AJOUTER UN NOUVEAU TYPE DE SIÈGE",
    remove_a_new_type: "SUPPRIMER LE DERNIER TYPE DE SIÈGE AJOUTÉ",
    venue_not_found: "VENUE NON TROUVÉ",
    seat_count_error: "Le nombre de places par rangée doit être inférieur à 30 et supérieur à 0",
    seat_count: "Nombre de sièges",
    address: "Adresse",
    enter_vid_update: "Entrez l'identifiant du concert que vous souhaitez mettre à jour",
    enter_vid_view: "Entrez l'ID du lieu que vous souhaitez consulter",
    enter_vid_delete: "Entrez l'ID du lieu que vous souhaitez supprimer",
    total_venue_seat_number: "Nombre total de sièges dans la salle",
    total_seat: "Nombre total de sièges",
    select_country: "Sélectionnez le pays",
    close: "Fermer",
  },
};

let admin_content = document.getElementById("admincontent");

let MAX_SEAT_PER_ROW = 30
let TYPE_COUNT = 0
let ROW_COUNT = 0
let VENUE_GOOD = true

/**Checks if time string is military format*/
function isMilitaryTime(time) {
  let parts = time.split(":");
  if (parts.length !== 2) {
    return false;
  } else if (parts[0].length > 2 || parts[1].length > 2) {
    return false;
  }

  let hours = parseInt(parts[0]);
  let minutes = parseInt(parts[1]);

  if (isNaN(hours) || isNaN(minutes)) {
    return false;
  }

  if (hours < 0 || hours > 23) {
    return false;
  }

  if (minutes < 0 || minutes > 59) {
    return false;
  }

  let date = new Date();
  date.setHours(hours, minutes);

  return date.getHours() === hours && date.getMinutes() === minutes;
}

/**Displays the create concert form*/
document.getElementById("createconcertbutton").addEventListener("click", () => {
  createLoadingCoverForElement(admin_content);
  activateLoadingCoverForElement(admin_content);

  let lang = translation(dictionary);

  fetch("/concert/api/venues/")
      .then((response) => {
        return response.json();
      })
      .then((data) => {
        admin_content.innerHTML = `<br>
        <div class="container">
            <div class="ticket-container">
            <div class="ticket-info-box">
                <h2 class="text-center concert_title attention_color font_family" style="margin-top: 0;">*${lang.concert_name}</h2>
            <div class="form-group mb-3">
                <input type="text" name="concertname" id="concertname" placeholder=${lang.concert_name} class="form-control" required>
                <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
            </div>
                <div class="divider dividor_color"></div>
                <p  class="detail_list_item regular_color">*${lang.poster_url}:</p>
                <div class="form-group mb-3">
                    <input type="text" name="concertimageurl" id="concertimageurl" placeholder="https://i.imgur.com/y8wLfxd.jpeg" class="form-control" required>
                </div>   
            <div class="ticket-img-box">         
                <img id="concertimage" src="https://via.placeholder.com/450x300" alt="Concert Poster" class="ticket-img img-fluid"/>
            </div>
            <button class="btn button_color font_family" id="create_concert_button">${lang.create_concert_button}</button>
            <p style="color: red;" id="global_error_message"></p>
        </div>
        <div class="ticket-info-box">
          <h2 class="text-center concert_title attention_color font_family" style="margin-top: 0;">${lang.details}</h2>
          <div class="divider dividor_color"></div>
            <br>
            <p id="performer_name" class="detail_list_item regular_color">*${lang.performer_name}:</p>
            <div class="form-group mb-3">
                <input type="text" name="performername" id="performername" placeholder=${lang.performer_name} class="form-control" required>
            </div>
            
            <p class="detail_list_item regular_color">*${lang.genre}:</p>
            <div class="form-group mb-3">
                <select id="genrename" name="genrename" class="form-control" required>
                <option selected disabled value="#">${lang.genre_stuff.select_genre}</option>
                <option value="Blues">${lang.genre_stuff.blues}</option>
                <option value="Classical">${lang.genre_stuff.classical}</option>
                <option value="Country">${lang.genre_stuff.country}</option>
                <option value="Dance">${lang.genre_stuff.dance}</option>
                <option value="EDM">${lang.genre_stuff.electronic}</option>
                <option value="Folk">${lang.genre_stuff.folk}</option>
                <option value="Hip-Hop">${lang.genre_stuff.hiphop}</option>
                <option value="Jazz">${lang.genre_stuff.jazz}</option>
                <option value="Metal">${lang.genre_stuff.metal}</option>
                <option value="Pop">${lang.genre_stuff.pop}</option>
                <option value="Reggae">${lang.genre_stuff.reggae}</option>
                <option value="Rock">${lang.genre_stuff.rock}</option>
                <option value="Soul">${lang.genre_stuff.soul}</option>
                <option value="World">${lang.genre_stuff.world}</option>          
            </select>  </div>
                                               
            <p id="age_toattend" class="detail_list_item regular_color">*${lang.age_to_attend}:</p>
            <div class="form-group mb-3">
                <input type="number" name="agetoattend" id="agetoattend" placeholder=${lang.enter_age} class="form-control" required>
                <div><small id="age_to_attend_error" class="font_family" style="color: red;"></small></div>
            </div>               
            
            
            <p id="dateofconcert" class="detail_list_item regular_color">*${lang.date}:</p>
            <div class="form-group mb-3">
                <input type="date" class="form-control mr-3" id="concertdate">
            </div>  
            
            
            <p id="concertstarttime" class="detail_list_item regular_color">*${lang.doors_open}:</p>
            <div class="form-group mb-3">
                <input type="text" name="concertdoorsopen" id="concertdoorsopen" placeholder="18:30" class="form-control" required>
                <div><small id="doors_open_error" class="font_family" style="color: red;"></small></div>
            </div>
            
            
            <p id="concertendtime" class="detail_list_item regular_color">*${lang.doors_close}:</p>
            <div class="form-group mb-3">
                <input type="text" name="concertdoorsclose" id="concertdoorsclose" placeholder="20:30" class="form-control" required>
                <div><small id="doors_close_error" class="font_family" style="color: red;"></small></div>
            </div>    
                     
            <div class="form-group form-check d-flex align-items-center regular_color">
                <label class="mb-0">
                    <input id="disability_access" type="checkbox" class="form-check-input mr-2">${lang.disability_access}
                </label>
            </div>

            <div class="form-group form-check d-flex align-items-center regular_color">
                <label class="mb-0">
                    <input id="deal" type="checkbox" class="form-check-input mr-2">${lang.deal}
                </label>
            </div>
            
            
            
            
        
            <p id="venue_name" class="detail_list_item regular_color">*${lang.venue_name}:</p>
            <div class="form-group mb-3">
                <select id="venuename" name="venuename" class="form-control" required>
                <option selected disabled value="#">${lang.select_venue}</option>
            </select>        
            `;

        for (let i = 0; i < data.length; ++i) {
          document.getElementById(
              "venuename"
          ).innerHTML += `<option id="${i}option" value="${data[i].name}">${data[i].name}</option>`;
          if (i === data.length) {
            admin_content += `</div>`;
          }
        }

        admin_content.innerHTML += `
                      <p id="venue_address" class="detail_list_item regular_color">${lang.venue_address}:</p>
                      <div class="form-group mb-3">
                          <input type="text" name="venueaddress" value="" id="venueaddress" class="form-control" required readonly>
                          <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
                      </div>
          
          
          
                      <p id="concertcity" class="detail_list_item regular_color">${lang.city}:</p>
                      <div class="form-group mb-3">
                          <input type="text" name="venuecity" readonly id="venuecity" value="" class="form-control" required>
                          <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
                      </div>
          
                      <p id="concertcountry" class="detail_list_item regular_color">${lang.country}:</p>
                      <div class="form-group mb-3">
                          <input type="text" name="venuecountry" id="venuecountry" value="" class="form-control" required>
                          <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
                      </div>
                                             
                              <div class="form-group mb-3"> 
                              <p id="seatingarrangement" class="detail_list_item regular_color">${lang.seats}:</p>  
                       <table class="table">
                          <thead class="thead-dark">
                              <tr>
                                  <th scope="col" class="regular_color">${lang.seat_type}</th>
                                  <th scope="col" class="regular_color">${lang.total_amount}</th>
                                  <th scope="col" class="regular_color">*${lang.amount_to_reserve}</th>
                                  <th scope="col" class="regular_color">*${lang.price_per_seat}</th>
                              </tr>
                          </thead>
                          <tbody id="seattable">
                          </tbody>
                       </table>          
                      </div>
                        <p id="tickets_available" class="detail_list_item regular_color">${lang.tickets_available}:</p>
                            <div class="form-group mb-3">
                            <input type="number" name="ticketsavailable" id="ticketsavailable" placeholder="0" class="form-control" required>
                            <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
                            </div>                         
                      <br>`;
        disableLoadingCoverForElement(admin_content);
        return data;
      })
      .then((data) => {
        document
            .getElementById("concertdoorsopen")
            .addEventListener("change", () => {
              if (
                  !isMilitaryTime(document.getElementById("concertdoorsopen").value)
              ) {
                document.getElementById(
                    "doors_open_error"
                ).innerText = `*${lang.time_format_error}`;
              } else {
                document.getElementById("doors_open_error").innerText = "";
              }
            });

        document
            .getElementById("concertdoorsclose")
            .addEventListener("change", () => {
              if (
                  !isMilitaryTime(document.getElementById("concertdoorsclose").value)
              ) {
                document.getElementById(
                    "doors_close_error"
                ).innerText = `*${lang.time_format_error}`;
              } else {
                document.getElementById("doors_close_error").innerText = "";
              }
            });

        document.getElementById("agetoattend").addEventListener("change", () => {
          if (+document.getElementById("agetoattend").value < 0) {
            document.getElementById(
                "age_to_attend_error"
            ).innerText = `*${lang.age_to_attend_error}`;
          } else {
            document.getElementById("age_to_attend_error").innerText = "";
          }
        });

        document.getElementById(`venuename`).addEventListener("change", () => {
          for (let i = 0; i < data.length; ++i) {
            if (
                data[i]["name"] ===
                document.getElementById("venuename").selectedOptions[0].innerText
            ) {
              document.getElementById("venueaddress").value = data[i]["address"];
              document.getElementById("venuecity").value = data[i]["city"];
              document.getElementById("venuecountry").value = data[i]["country"];
              document.getElementById("seattable").innerHTML = "";
              for (let j = 0; j < data[i]["seating"].length; ++j) {
                document.getElementById("seattable").innerHTML += `
                               <tr class="regular_color">
                                  <th scope="row">${data[i]["seating"][j]["type"]}</th>
                                  <td>${data[i]["seating"][j]["total"]}</td>
                                  <td><input type="number" min="0" name="${data[i]["seating"][j]["type"]}number" id="${data[i]["seating"][j]["type"]}number"  class="form-control" required placeholder="0"></td>
                                  <td><input type="number" min="0" name="${data[i]["seating"][j]["type"]}price" id="${data[i]["seating"][j]["type"]}price" class="form-control" required placeholder="0.0"></td>
                              </tr>                  
                  `;
              }

              for (let j = 0; j < data[i]["seating"].length; ++j) {
                let tickets_available =
                    document.getElementById("ticketsavailable");
                let seat_number = document.getElementById(
                    `${data[i]["seating"][j]["type"]}number`
                );

                seat_number.addEventListener("change", () => {
                  let total = 0;

                  for (let k = 0; k < data[i]["seating"].length; ++k) {
                    let number_of_seats = document.getElementById(
                        `${data[i]["seating"][k]["type"]}number`
                    );

                    if (number_of_seats.value < 0) {
                      number_of_seats.value = 0;
                    }

                    if (number_of_seats.value > data[i]["seating"][k]["total"]) {
                      number_of_seats.value = data[i]["seating"][k]["total"];
                    }
                    total += +number_of_seats.value;
                  }

                  if (total > data[i]["seat_count_total"]) {
                    tickets_available.value = data[i]["seat_count_total"];
                  } else {
                    tickets_available.value = total;
                  }
                });
              }
            }
          }
        });

        document
            .getElementById("concertimageurl")
            .addEventListener("change", () => {
              let the_url = document.getElementById("concertimageurl").value;
              let concert_poster = document.getElementById("concertimage");

              if (
                  the_url !== "" &&
                  (the_url.endsWith(".jpeg") ||
                      the_url.endsWith(".gif") ||
                      the_url.endsWith(".png") ||
                      the_url.endsWith(".apng") ||
                      the_url.endsWith(".svg") ||
                      the_url.endsWith(".bmp") ||
                      the_url.endsWith(".jpg"))
              ) {
                concert_poster.src = the_url;
              } else {
                concert_poster.src = "https://via.placeholder.com/450x300";
              }
            });

        // Create button event listener
        document
            .getElementById("create_concert_button")
            .addEventListener("click", () => {
              createLoadingCoverForElement(admin_content);
              activateLoadingCoverForElement(admin_content);

              let concertname = document.getElementById("concertname").value;
              let posterurl = document.getElementById("concertimageurl").value;
              let performer_name = document.getElementById("performername").value;
              let age_to_attend = document.getElementById("agetoattend").value;
              // do date here

              const date = new Date(document.getElementById("concertdate").value);

              let year = date.getFullYear();
              let month = date.getMonth() + 1;
              let day = date.getDate() + 1;

              let concert_start_time =
                  document.getElementById("concertdoorsopen").value;
              let concert_end_time =
                  document.getElementById("concertdoorsclose").value;
              let venue_name =
                  document.getElementById("venuename").selectedOptions[0].value;
              let tickets_available =
                  document.getElementById("ticketsavailable").value;

              let genre =
                  document.getElementById("genrename").selectedOptions[0].value;

              // returns bool
              let disability_access =
                  document.getElementById("disability_access").checked;

              let deal = document.getElementById("deal").checked;

              let sold_tickets = 0;

              let times_viewed = 0;
              let venue = {};

              if (
                  concertname !== "" &&
                  posterurl !== "" &&
                  performer_name !== "" &&
                  age_to_attend &&
                  age_to_attend > 0 &&
                  year &&
                  month &&
                  day &&
                  concert_start_time &&
                  concert_end_time &&
                  venue_name !== "#" &&
                  tickets_available &&
                  genre !== "#"
              ) {
                for (let i = 0; i < data.length; ++i) {
                  if (data[i]["name"] === venue_name) {
                    venue = data[i];
                    break;
                  }
                }

                let price_list = [];

                for (let i = 0; i < venue["seating"].length; ++i) {
                  venue["seating"][i]["price"] = +document.getElementById(
                      `${venue["seating"][i]["type"]}price`
                  ).value;
                  price_list.push(venue["seating"][i]["price"]);

                  venue["seating"][i]["available"] = +document.getElementById(
                      `${venue["seating"][i]["type"]}number`
                  ).value;
                  venue["seating"][i]["available_for_booking"] =
                      +document.getElementById(`${venue["seating"][i]["type"]}number`)
                          .value; ////////

                  venue["seating"][i]["sold"] = 0;
                  venue["seating"][i]["seats"] = [];

                  for (
                      let j = 0;
                      j < venue["seating"][i]["available_for_booking"];
                      ++j
                  ) {
                    venue["seating"][i]["seats"].push({
                      id: j + 1,
                      vacant: true,
                    });
                  }
                }

                let cheapest_seat = Math.min(...price_list);

                venue["cheapest_seat"] = cheapest_seat;

                if (cheapest_seat !== 0) {
                  // Creating giga concert object
                  fetch("/concert/api/nextconcertid/")
                      .then((response) => {
                        return response.json();
                      })
                      .then((data) => {
                        let concert = {
                          _id: data["_id"],
                          name: concertname,
                          poster: posterurl,
                          performer: performer_name,
                          sold_tickets: sold_tickets,
                          times_viewed: times_viewed,
                          genre: genre,
                          tickets_available: +tickets_available,
                          age_to_attend: +age_to_attend,
                          disability_accessible: disability_access,
                          deal: deal,
                          date: {
                            year: year,
                            month: month,
                            day: day,
                          },
                          time: {
                            start: concert_start_time,
                            end: concert_end_time,
                          },
                          venue: venue,
                        };

                        fetch("/concert/api/createconcert/", {
                          method: "POST",
                          headers: {
                            "Content-Type": "application/json",
                          },
                          body: JSON.stringify(concert),
                        })
                            .then((response) => {
                              return response.json();
                            })
                            .then((data) => {
                              admin_content.innerHTML = `<div class="ticket-info-box">
                                            <h2 class="text-center attention_color" style="margin-top: 0;" id="concertname">${data["message"]}</h2>
                                                </div>
                                            `;
                              disableLoadingCoverForElement(admin_content);
                            })
                            .catch((error) => {
                              console.log(error);
                            });
                      })
                      .catch((err) => {
                        console.log(err);
                      });
                } else {
                  document.getElementById("global_error_message").innerText =
                      "A ticket price cannot be 0";
                }
              } else {
                document.getElementById("global_error_message").innerText =
                    "Please fill out all the required fields that begin with *";
              }
              // console.log(JSON.stringify(concert));
            });
      })
      .catch((err) => {
        console.log(err);
      });
});

document.getElementById("updateconcertbutton").addEventListener("click", () => {
  let lang = translation(dictionary);

  admin_content.innerHTML = `
        <div class="container">
                <div class="divider dividor_color"></div>
                    <p  class="detail_list_item regular_color">${lang.enter_id_update}:</p>
                <div class="form-group mb-3">
                    <input type="number" name="concert_search" id="concert_search" placeholder=${lang.enter_concert_id} class="form-control" required>
                </div> 
                <button class="btn button_color font_family" id="concert_search_button">${lang.search}</button>
                <p style="color: red;" id="global_error_message"></p>
        </div>        
        `;

  document
      .getElementById("concert_search_button")
      .addEventListener("click", () => {
        createLoadingCoverForElement(admin_content);
        activateLoadingCoverForElement(admin_content);
        fetch(
            `/concert/api/concertbyid/?id=${+document.getElementById(
                "concert_search"
            ).value}`
        )
            .then((response) => response.json())
            .then((concertData) => {
              if (concertData["message"]) {
                document.getElementById("global_error_message").innerText =
                    lang.concert_not_found;
                disableLoadingCoverForElement(admin_content);
              } else {
                fetch("/concert/api/venues/")
                    .then((response) => {
                      return response.json();
                    })
                    .then((data) => {
                      admin_content.innerHTML = `<br>
        <div class="container">
            <div class="ticket-container">
            <div class="ticket-info-box">
                <h2 class="text-center concert_title attention_color font_family" style="margin-top: 0;">*${
                          lang.concert_name
                      }</h2>
            <div class="form-group mb-3">
                <input type="text" value="${
                          concertData["name"]
                      }" name="concertname" id="concertname" placeholder=${
                          lang.concert_name
                      } class="form-control" required>
                <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
            </div>
                <div class="divider dividor_color"></div>
                <p  class="detail_list_item regular_color">*${
                          lang.poster_url
                      }:</p>
                <div class="form-group mb-3">
                    <input type="text" value="${
                          concertData["poster"]
                      }" name="concertimageurl" id="concertimageurl" placeholder="https://i.imgur.com/y8wLfxd.jpeg" class="form-control" required>
                </div>   
            <div class="ticket-img-box">         
                <img id="concertimage" src="${
                          concertData["poster"]
                      }" alt="Concert Poster" class="ticket-img img-fluid"/>
            </div>
            <button class="btn button_color font_family" id="create_concert_button">${
                          lang.update_concert_button
                      }</button>
            <p style="color: red;" id="global_error_message"></p>
        </div>
        <div class="ticket-info-box">
          <h2 class="text-center concert_title attention_color font_family" style="margin-top: 0;">${
                          lang.details
                      }</h2>
          <div class="divider dividor_color"></div>
            <br>
            <p id="performer_name" class="detail_list_item regular_color">*${
                          lang.performer_name
                      }:</p>
            <div class="form-group mb-3">
                <input type="text" value="${
                          concertData["performer"]
                      }" name="performername" id="performername" placeholder=${
                          lang.performer_name
                      } class="form-control" required>
            </div>
            
            <p class="detail_list_item regular_color">*${lang.genre}:</p>
            <div class="form-group mb-3">
                <select id="genrename" name="genrename" class="form-control" required>
                <option ${
                          concertData["genre"] === "Blues" ? "selected" : ""
                      } value="Blues">${lang.genre_stuff.blues}</option>
                <option ${
                          concertData["genre"] === "Classical" ? "selected" : ""
                      } value="Classical">${lang.genre_stuff.classical}</option>
                <option ${
                          concertData["genre"] === "Country" ? "selected" : ""
                      } value="Country">${lang.genre_stuff.country}</option>
                <option ${
                          concertData["genre"] === "Dance" ? "selected" : ""
                      } value="Dance">${lang.genre_stuff.dance}</option>
                <option ${
                          concertData["genre"] === "EDM" ? "selected" : ""
                      } value="EDM">${lang.genre_stuff.electronic}</option>
                <option ${
                          concertData["genre"] === "Folk" ? "selected" : ""
                      } value="Folk">${lang.genre_stuff.folk}</option>
                <option ${
                          concertData["genre"] === "Hip-Hop" ? "selected" : ""
                      } value="Hip-Hop">${lang.genre_stuff.hiphop}</option>
                <option ${
                          concertData["genre"] === "Jazz" ? "selected" : ""
                      } value="Jazz">${lang.genre_stuff.jazz}</option>
                <option ${
                          concertData["genre"] === "Metal" ? "selected" : ""
                      } value="Metal">${lang.genre_stuff.metal}</option>
                <option ${
                          concertData["genre"] === "Pop" ? "selected" : ""
                      } value="Pop">${lang.genre_stuff.pop}</option>
                <option ${
                          concertData["genre"] === "Reggae" ? "selected" : ""
                      } value="Reggae">${lang.genre_stuff.reggae}</option>
                <option ${
                          concertData["genre"] === "Rock" ? "selected" : ""
                      } value="Rock">${lang.genre_stuff.rock}</option>
                <option ${
                          concertData["genre"] === "Soul" ? "selected" : ""
                      } value="Soul">${lang.genre_stuff.soul}</option>
                <option ${
                          concertData["genre"] === "World" ? "selected" : ""
                      } value="World">${lang.genre_stuff.world}</option>          
            </select>  </div>
                                               
            <p id="age_toattend" class="detail_list_item regular_color">*${
                          lang.age_to_attend
                      }:</p>
            <div class="form-group mb-3">
                <input type="number" value="${
                          concertData["age_to_attend"]
                      }" name="agetoattend" id="agetoattend" placeholder=${
                          lang.enter_age
                      } class="form-control" required>
                <div><small id="age_to_attend_error" class="font_family" style="color: red;"></small></div>
            </div>               
            
            
            <p id="dateofconcert" class="detail_list_item regular_color">*${
                          lang.date
                      }:
            </p>
            <div class="form-group mb-3">
                <input type="date" value="${concertData["date"]["year"]}-${
                          concertData["date"]["month"] < 10
                              ? "0" + concertData["date"]["month"]
                              : concertData["date"]["month"]
                      }-${
                          concertData["date"]["day"] < 10
                              ? "0" + concertData["date"]["day"]
                              : concertData["date"]["day"]
                      }" class="form-control mr-3" id="concertdate">
            </div>  
            
            
            <p id="concertstarttime" class="detail_list_item regular_color">*${
                          lang.doors_open
                      }:</p>
            <div class="form-group mb-3">
                <input type="text" value="${
                          concertData["time"]["start"]
                      }" name="concertdoorsopen" id="concertdoorsopen" placeholder="18:30" class="form-control" required>
                <div><small id="doors_open_error" class="font_family" style="color: red;"></small></div>
            </div>
            
            
            <p id="concertendtime" class="detail_list_item regular_color">*${
                          lang.doors_close
                      }:</p>
            <div class="form-group mb-3">
                <input type="text" value="${
                          concertData["time"]["end"]
                      }" name="concertdoorsclose" id="concertdoorsclose" placeholder="20:30" class="form-control" required>
                <div><small id="doors_close_error" class="font_family" style="color: red;"></small></div>
            </div>    
                     
            <div class="form-group form-check d-flex align-items-center regular_color">
                <label class="mb-0">
                    <input id="disability_access" ${
                          concertData["disability_accessible"] ? "checked" : ""
                      } type="checkbox" class="form-check-input mr-2">${
                          lang.disability_access
                      }
                </label>
            </div>

            <div class="form-group form-check d-flex align-items-center regular_color">
                <label class="mb-0">
                    <input id="deal" ${
                          concertData["deal"] ? "checked" : ""
                      } type="checkbox" class="form-check-input mr-2">${lang.deal}
                </label>
            </div>
            
            
            
            
        
            <p id="venue_name" class="detail_list_item regular_color">*${
                          lang.venue_name
                      }:</p>
            <div class="form-group mb-3">
                <select id="venuename" name="venuename" class="form-control" required>
                <option selected disabled value="${
                          concertData["venue"]["name"]
                      }">${concertData["venue"]["name"]}</option>
            </select>        
            `;

                      admin_content.innerHTML += `
                      <p id="venue_address" class="detail_list_item regular_color">${lang.venue_address}:</p>
                      <div class="form-group mb-3">
                          <input type="text" value="${concertData["venue"]["address"]}" name="venueaddress" value="" id="venueaddress" class="form-control" required readonly>
                          <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
                      </div>
          
          
          
                      <p id="concertcity" class="detail_list_item regular_color">${lang.city}:</p>
                      <div class="form-group mb-3">
                          <input type="text" value="${concertData["venue"]["city"]}" name="venuecity" readonly id="venuecity" value="" class="form-control" required>
                          <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
                      </div>
          
                      <p id="concertcountry" class="detail_list_item regular_color">${lang.country}:</p>
                      <div class="form-group mb-3">
                          <input type="text" value="${concertData["venue"]["country"]}" name="venuecountry" id="venuecountry" value="" class="form-control" required>
                          <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
                      </div>
                                             
                              <div class="form-group mb-3"> 
                              <p id="seatingarrangement" class="detail_list_item regular_color">${lang.seats}:</p>  
                       <table class="table">
                          <thead class="thead-dark">
                              <tr>
                                  <th scope="col" class="regular_color">${lang.seat_type}</th>
                                  <th scope="col" class="regular_color">${lang.total_amount}</th>
                                  <th scope="col" class="regular_color">*${lang.amount_to_reserve}</th>
                                  <th scope="col" class="regular_color">*${lang.price_per_seat}</th>
                              </tr>
                          </thead>
                          <tbody id="seattable">
                          </tbody>
                       </table>          
                      </div>
                        <p id="tickets_available" class="detail_list_item regular_color">${lang.tickets_available}:</p>
                            <div class="form-group mb-3">
                            <input type="number" value="${concertData["tickets_available"]}" name="ticketsavailable" id="ticketsavailable" placeholder="0" class="form-control" required>
                            <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
                            </div>                         
                      <br>`;

                      disableLoadingCoverForElement(admin_content);
                      return data;
                    })
                    .then((data) => {
                      document
                          .getElementById("concertdoorsopen")
                          .addEventListener("change", () => {
                            if (
                                !isMilitaryTime(
                                    document.getElementById("concertdoorsopen").value
                                )
                            ) {
                              document.getElementById(
                                  "doors_open_error"
                              ).innerText = `*${lang.time_format_error}`;
                            } else {
                              document.getElementById("doors_open_error").innerText =
                                  "";
                            }
                          });

                      document
                          .getElementById("concertdoorsclose")
                          .addEventListener("change", () => {
                            if (
                                !isMilitaryTime(
                                    document.getElementById("concertdoorsclose").value
                                )
                            ) {
                              document.getElementById(
                                  "doors_close_error"
                              ).innerText = `*${lang.time_format_error}`;
                            } else {
                              document.getElementById("doors_close_error").innerText =
                                  "";
                            }
                          });

                      document
                          .getElementById("agetoattend")
                          .addEventListener("change", () => {
                            if (+document.getElementById("agetoattend").value < 0) {
                              document.getElementById(
                                  "age_to_attend_error"
                              ).innerText = `*${lang.age_to_attend_error}`;
                            } else {
                              document.getElementById("age_to_attend_error").innerText =
                                  "";
                            }
                          });

                      document.getElementById("venueaddress").value =
                          concertData["venue"]["address"];
                      document.getElementById("venuecity").value =
                          concertData["venue"]["city"];
                      document.getElementById("venuecountry").value =
                          concertData["venue"]["country"];
                      document.getElementById("seattable").innerHTML = "";
                      for (
                          let j = 0;
                          j < concertData["venue"]["seating"].length;
                          ++j
                      ) {
                        console.log(j);
                        document.getElementById("seattable").innerHTML += `
                               <tr class="regular_color">
                                  <th scope="row">${concertData["venue"]["seating"][j]["type"]}</th>
                                  <td>${concertData["venue"]["seating"][j]["total"]}</td>
                                  <td><input type="number" value="${concertData["venue"]["seating"][j]["available_for_booking"]}" min="0" name="${concertData["venue"]["seating"][j]["type"]}number" id="${concertData["venue"]["seating"][j]["type"]}number"  class="form-control" required placeholder="0"></td>
                                  <td><input type="number" value="${concertData["venue"]["seating"][j]["price"]}" min="0" name="${concertData["venue"]["seating"][j]["type"]}price" id="${concertData["venue"]["seating"][j]["type"]}price" class="form-control" required placeholder="0.0"></td>
                              </tr>                  
                  `;
                      }
                      for (
                          let j = 0;
                          j < concertData["venue"]["seating"].length;
                          ++j
                      ) {
                        let tickets_available =
                            document.getElementById("ticketsavailable");
                        let seat_number = document.getElementById(
                            `${concertData["venue"]["seating"][j]["type"]}number`
                        );

                        seat_number.addEventListener("change", () => {
                          let total = 0;

                          for (
                              let k = 0;
                              k < concertData["venue"]["seating"].length;
                              ++k
                          ) {
                            let number_of_seats = document.getElementById(
                                `${concertData["venue"]["seating"][k]["type"]}number`
                            );

                            if (number_of_seats.value < 0) {
                              number_of_seats.value = 0;
                            }

                            if (
                                number_of_seats.value >
                                concertData["venue"]["seating"][k]["total"]
                            ) {
                              number_of_seats.value =
                                  concertData["venue"]["seating"][k]["total"];
                            }

                            if (
                                number_of_seats.value <
                                concertData["venue"]["seating"][k][
                                    "available_for_booking"
                                    ]
                            ) {
                              number_of_seats.value =
                                  concertData["venue"]["seating"][k][
                                      "available_for_booking"
                                      ];
                            }
                            total += +number_of_seats.value;
                          }

                          if (total > concertData["venue"]["seat_count_total"]) {
                            tickets_available.value =
                                concertData["venue"]["seat_count_total"];
                          } else {
                            tickets_available.value = total;
                          }
                        });
                      }

                      document
                          .getElementById("concertimageurl")
                          .addEventListener("change", () => {
                            let the_url =
                                document.getElementById("concertimageurl").value;
                            let concert_poster =
                                document.getElementById("concertimage");

                            if (
                                the_url !== "" &&
                                (the_url.endsWith(".jpeg") ||
                                    the_url.endsWith(".gif") ||
                                    the_url.endsWith(".png") ||
                                    the_url.endsWith(".apng") ||
                                    the_url.endsWith(".svg") ||
                                    the_url.endsWith(".bmp") ||
                                    the_url.endsWith(".jpg"))
                            ) {
                              concert_poster.src = the_url;
                            } else {
                              concert_poster.src =
                                  "https://via.placeholder.com/450x300";
                            }
                          });

                      // Create button event listener
                      document
                          .getElementById("create_concert_button")
                          .addEventListener("click", () => {
                            createLoadingCoverForElement(admin_content);
                            activateLoadingCoverForElement(admin_content);
                            let concertname =
                                document.getElementById("concertname").value;
                            let posterurl =
                                document.getElementById("concertimageurl").value;
                            let performer_name =
                                document.getElementById("performername").value;
                            let age_to_attend =
                                document.getElementById("agetoattend").value;
                            // do date here

                            const date = new Date(
                                document.getElementById("concertdate").value
                            );

                            let year = date.getFullYear();
                            let month = date.getMonth() + 1;
                            let day = date.getDate() + 1;

                            let concert_start_time =
                                document.getElementById("concertdoorsopen").value;
                            let concert_end_time =
                                document.getElementById("concertdoorsclose").value;
                            let venue_name =
                                document.getElementById("venuename").selectedOptions[0]
                                    .value;
                            let tickets_available =
                                document.getElementById("ticketsavailable").value;

                            let genre =
                                document.getElementById("genrename").selectedOptions[0]
                                    .value;

                            // returns bool
                            let disability_access =
                                document.getElementById("disability_access").checked;

                            let deal = document.getElementById("deal").checked;

                            let venue = concertData["venue"];

                            if (
                                concertname !== "" &&
                                posterurl !== "" &&
                                performer_name !== "" &&
                                age_to_attend &&
                                age_to_attend > 0 &&
                                year &&
                                month &&
                                day &&
                                concert_start_time &&
                                concert_end_time &&
                                venue_name !== "#" &&
                                tickets_available &&
                                genre !== "#"
                            ) {
                              // for (let i = 0; i < data.length; ++i) {
                              //   if (data[i]["name"] === venue_name) {
                              //     venue = data[i];
                              //     break;
                              //   }
                              // }

                              let price_list = [];

                              for (let i = 0; i < venue["seating"].length; ++i) {
                                venue["seating"][i]["price"] = +document.getElementById(
                                    `${venue["seating"][i]["type"]}price`
                                ).value;
                                price_list.push(venue["seating"][i]["price"]);

                                venue["seating"][i]["available"] =
                                    +document.getElementById(
                                        `${venue["seating"][i]["type"]}number`
                                    ).value;
                                venue["seating"][i]["available_for_booking"] =
                                    +document.getElementById(
                                        `${venue["seating"][i]["type"]}number`
                                    ).value; ////////

                                venue["seating"][i]["sold"] =
                                    concertData["venue"]["seating"][i]["sold"];
                                venue["seating"][i]["seats"] =
                                    concertData["venue"]["seating"][i]["seats"];

                                for (
                                    let j =
                                        concertData["venue"]["seating"][i]["seats"].length;
                                    j < venue["seating"][i]["available_for_booking"];
                                    ++j
                                ) {
                                  venue["seating"][i]["seats"].push({
                                    id: j + 1,
                                    vacant: true,
                                  });
                                }
                              }

                              let cheapest_seat = Math.min(...price_list);

                              venue["cheapest_seat"] = cheapest_seat;

                              if (cheapest_seat !== 0) {
                                // Creating giga concert object
                                fetch("/concert/api/nextconcertid/")
                                    .then((response) => {
                                      return response.json();
                                    })
                                    .then((data) => {
                                      let concert = {
                                        _id: concertData["_id"],
                                        name: concertname,
                                        poster: posterurl,
                                        performer: performer_name,
                                        sold_tickets: concertData["sold_tickets"],
                                        times_viewed: concertData["times_viewed"],
                                        genre: genre,
                                        tickets_available: +tickets_available,
                                        age_to_attend: +age_to_attend,
                                        disability_accessible: disability_access,
                                        deal: deal,
                                        date: {
                                          year: year,
                                          month: month,
                                          day: day,
                                        },
                                        time: {
                                          start: concert_start_time,
                                          end: concert_end_time,
                                        },
                                        venue: venue,
                                      };

                                      fetch("/concert/api/updateconcert/", {
                                        method: "POST",
                                        headers: {
                                          "Content-Type": "application/json",
                                        },
                                        body: JSON.stringify(concert),
                                      })
                                          .then((response) => {
                                            return response.json();
                                          })
                                          .then((data) => {
                                            admin_content.innerHTML = `<div class="ticket-info-box">
                                                                    <h2 class="text-center attention_color" style="margin-top: 0;" id="concertname">${data["message"]}</h2>
                                                                    </div>
                                                                `;
                                            disableLoadingCoverForElement(admin_content);
                                          })
                                          .catch((error) => {
                                            console.log(error);
                                          });
                                    })
                                    .catch((err) => {
                                      console.log(err);
                                    });
                              } else {
                                document.getElementById(
                                    "global_error_message"
                                ).innerText = "A ticket price cannot be 0";
                              }
                            } else {
                              document.getElementById(
                                  "global_error_message"
                              ).innerText =
                                  "Please fill out all the required fields that begin with *";
                            }
                            // console.log(JSON.stringify(concert));
                          });
                    })
                    .catch((err) => {
                      console.log(err);
                    });

                /////////////////////////////////////
              }
            })
            .catch((err) => {
              admin_content.innerHTML = `
                    <div class="container">
                        <div class="divider dividor_color"></div>
                            <p  class="detail_list_item regular_color">${lang.enter_id_update}:</p>
                        <div class="form-group mb-3">
                            <input type="number" name="concert_search" id="concert_search" placeholder=${lang.enter_concert_id} class="form-control" required>
                        </div> 
                        <button class="btn button_color font_family" id="concert_search_button">${lang.search}</button>
                        <p style="color: red;" id="global_error_message">${lang.concert_not_found}</p>
                    </div>        
                    `;
            });
      });
});

document.getElementById("viewconcertbutton").addEventListener("click", () => {
  let lang = translation(dictionary);
  admin_content.innerHTML = `
        <div class="container">
                <div class="divider dividor_color"></div>
                    <p  class="detail_list_item regular_color">${lang.enter_id_view}:</p>
                <div class="form-group mb-3">
                    <input type="number" name="concert_view_search" id="concert_view_search" placeholder=${lang.enter_id_view} class="form-control" required>
                </div> 
                <button class="btn button_color font_family" id="concert_search_view_button">${lang.search}</button>
                <p style="color: red;" id="global_error_message"></p>
        </div>        
        `;

  document
      .getElementById("concert_search_view_button")
      .addEventListener("click", () => {
        createLoadingCoverForElement(admin_content);
        activateLoadingCoverForElement(admin_content);
        fetch(
            `/concert/api/concertbyid/?id=${+document.getElementById(
                "concert_view_search"
            ).value}`
        )
            .then((response) => response.json())
            .then((data) => {
              if (data["message"]) {
                document.getElementById("global_error_message").innerText =
                    lang.concert_not_found;
                disableLoadingCoverForElement(admin_content);
              } else {
                //////////////////////////////////////
                admin_content.innerHTML = `
<br>
<div class="container">
    <div class="ticket-container">
        <div class="ticket-info-box">
            <h2 class="text-center concert_title attention_color font_family" style="margin-top: 0;" id="concertname">${lang.concert_name}</h2>
            <div class="divider dividor_color"></div>

            <div class="ticket-img-box">
                <img id="concertimage" src="https://via.placeholder.com/450x300" alt="Concert Poster" class="ticket-img img-fluid"/>
            </div>
            
        </div>
        <div class="ticket-info-box">
          <h2 class="text-center concert_title attention_color font_family" style="margin-top: 0;">${lang.details}</h2>
          <div class="divider dividor_color"></div>
            <br>
            <p id="performername" class="detail_list_item regular_color"></p>
            <p id="ticketsavailable" class="detail_list_item regular_color"></p>
            <p id="cheapestticket" class="detail_list_item regular_color"></p>
            <p id="agetoattend" class="detail_list_item regular_color"></p>
            <p id="dateofconcert" class="detail_list_item regular_color"></p>
            <p id="concertstarttime" class="detail_list_item regular_color"></p>
            <p id="concertendtime" class="detail_list_item regular_color"></p>
            <p id="venuename" class="detail_list_item regular_color"></p>
            <p id="venueaddress" class="detail_list_item regular_color"></p>
            <p id="concertcity" class="detail_list_item regular_color"></p>
            <p id="concertcountry" class="detail_list_item regular_color"></p>
        </div>
    </div>
</div>
<br>
                  `;

                document.getElementById("concertname").innerText = data["name"];
                document.getElementById("performername").innerText =
                    `${lang.performer_name}: ` + data["performer"];

                let tickets_available = 0;

                for (let i = 0; i < data["venue"]["seating"].length; ++i) {
                  tickets_available += data["venue"]["seating"][i]["available"];
                }

                document.getElementById("ticketsavailable").innerText =
                    `${lang.tickets_available}: ` + tickets_available;
                document.getElementById("cheapestticket").innerText =
                    `${lang.cheapest_ticket}: $` + data["venue"]["cheapest_seat"];
                document.getElementById("agetoattend").innerText =
                    `${lang.age_to_attend}: ` + data["age_to_attend"] + "+";
                document.getElementById(
                    "dateofconcert"
                ).innerText = `${lang.date}: ${data["date"]["year"]}/${data["date"]["month"]}/${data["date"]["day"]}`;

                document.getElementById("concertstarttime").innerText =
                    `${lang.doors_open}: ` + data["time"]["start"];
                document.getElementById("concertendtime").innerText =
                    `${lang.doors_close}: ` + data["time"]["end"];

                document.getElementById("venuename").innerText =
                    `${lang.venue_name}: ` + data["venue"]["name"];
                document.getElementById("venueaddress").innerText =
                    `${lang.venue_address}: ` + data["venue"]["address"];

                document.getElementById("concertcity").innerText =
                    `${lang.city}: ` + data["venue"]["city"];
                document.getElementById("concertcountry").innerText =
                    `${lang.country}: ` + data["venue"]["country"];

                document.getElementById("concertimage").src = data["poster"];

                disableLoadingCoverForElement(admin_content);
              }
            });
      });
});

document.getElementById("deleteconcertbutton").addEventListener("click", () => {
  let lang = translation(dictionary);

  admin_content.innerHTML = `
        <div class="container">
                <div class="divider dividor_color"></div>
                    <p  class="detail_list_item regular_color">${lang.enter_id_delete}:</p>
                <div class="form-group mb-3">
                    <input type="number" name="concert_view_search" id="concert_view_search" placeholder=${lang.enter_id_delete} class="form-control" required>
                </div> 
                <button class="btn button_color font_family" id="concert_search_view_button">${lang.search}</button>
                <p style="color: red;" id="global_error_message"></p>
        </div>        
        `;

  document
      .getElementById("concert_search_view_button")
      .addEventListener("click", () => {
        createLoadingCoverForElement(admin_content);
        activateLoadingCoverForElement(admin_content);
        fetch(
            `/concert/api/concertbyid/?id=${+document.getElementById(
                "concert_view_search"
            ).value}`
        )
            .then((response) => response.json())
            .then((data) => {
              if (data["message"]) {
                document.getElementById("global_error_message").innerText =
                    lang.concert_not_found;
                disableLoadingCoverForElement(admin_content);
              } else {
                //////////////////////////////////////
                admin_content.innerHTML = `
<br>
<div class="container">
    <div class="ticket-container">
        <div class="ticket-info-box">
            <h2 class="text-center concert_title attention_color font_family" style="margin-top: 0;" id="concertname">${lang.concert_name}</h2>
            <div class="divider dividor_color"></div>

            <div class="ticket-img-box">
                <img id="concertimage" src="https://via.placeholder.com/450x300" alt="Concert Poster" class="ticket-img img-fluid"/>
            </div>
            <button class="btn button_color font_family" id="delete_concert_button">${lang.delete_concert_button}</button>
        </div>
        <div class="ticket-info-box">
          <h2 class="text-center concert_title attention_color font_family" style="margin-top: 0;">${lang.details}</h2>
          <div class="divider dividor_color"></div>
            <br>
            <p id="performername" class="detail_list_item regular_color"></p>
            <p id="ticketsavailable" class="detail_list_item regular_color"></p>
            <p id="cheapestticket" class="detail_list_item regular_color"></p>
            <p id="agetoattend" class="detail_list_item regular_color"></p>
            <p id="dateofconcert" class="detail_list_item regular_color"></p>
            <p id="concertstarttime" class="detail_list_item regular_color"></p>
            <p id="concertendtime" class="detail_list_item regular_color"></p>
            <p id="venuename" class="detail_list_item regular_color"></p>
            <p id="venueaddress" class="detail_list_item regular_color"></p>
            <p id="concertcity" class="detail_list_item regular_color"></p>
            <p id="concertcountry" class="detail_list_item regular_color"></p>
        </div>
    </div>
</div>
<br>
                  `;

                document.getElementById("concertname").innerText = data["name"];
                document.getElementById("performername").innerText =
                    `Performer Name: ` + data["performer"];

                let tickets_available = 0;

                for (let i = 0; i < data["venue"]["seating"].length; ++i) {
                  tickets_available += data["venue"]["seating"][i]["available"];
                }

                document.getElementById("ticketsavailable").innerText =
                    `${lang.tickets_available}: ` + tickets_available;
                document.getElementById("cheapestticket").innerText =
                    `${lang.cheapest_ticket}: $` + data["venue"]["cheapest_seat"];
                document.getElementById("agetoattend").innerText =
                    `${lang.age_to_attend}: ` + data["age_to_attend"] + "+";
                document.getElementById(
                    "dateofconcert"
                ).innerText = `${lang.date}: ${data["date"]["year"]}/${data["date"]["month"]}/${data["date"]["day"]}`;

                document.getElementById("concertstarttime").innerText =
                    `${lang.doors_open}: ` + data["time"]["start"];
                document.getElementById("concertendtime").innerText =
                    `${lang.doors_close}: ` + data["time"]["end"];

                document.getElementById("venuename").innerText =
                    `${lang.venue_name}: ` + data["venue"]["name"];
                document.getElementById("venueaddress").innerText =
                    `${lang.venue_address}: ` + data["venue"]["address"];

                document.getElementById("concertcity").innerText =
                    `${lang.city}: ` + data["venue"]["city"];
                document.getElementById("concertcountry").innerText =
                    `${lang.country}: ` + data["venue"]["country"];

                document.getElementById("concertimage").src = data["poster"];

                disableLoadingCoverForElement(admin_content);

                document
                    .getElementById("delete_concert_button")
                    .addEventListener("click", () => {
                      createLoadingCoverForElement(admin_content);
                      activateLoadingCoverForElement(admin_content);
                      fetch(`/concert/api/deleteconcert/?id=${data["_id"]}`, {
                        method: "POST",
                        headers: {
                          "Content-Type": "application/json",
                        },
                        body: JSON.stringify(data["_id"]),
                      })
                          .then((response) => response.json())
                          .then((response_data) => {
                            admin_content.innerHTML = `<div class="ticket-info-box">
                            <h2 class="text-center attention_color" style="margin-top: 0;" id="concertname">${response_data["message"]}</h2>
                         </div>
                        `;
                            disableLoadingCoverForElement(admin_content);
                          })
                          .catch((err) => {
                            console.log(err);
                          });
                    });
              }
            });
      });
});

function generateRequestCards(data) {
  let lang = translation(dictionary);

  for (let i = 0; i < data.length; ++i) {
    let card_class = "card max-w-md shadow-lg mx-auto mb-3 background_color attention_color ";
    let buttonStyle = "btn ";
    if (data[i]["times_viewed"] === 0) {
      card_class += "border_color_second";
      buttonStyle += "button_color"
    } else {
      card_class += " border_color_second_viewed";
      buttonStyle += "viewed_color";
    }

    document.getElementById("cards_container").innerHTML += `
            <div class="row">
                <div class="${card_class}">
                    <div class="row no-gutters">
                        <div class="col-md-3">
                            <img src="${data[i]["poster"]}" class="card-img">
                        </div>
                        <div class="col-md-7">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card-body">
                                        <h5 class="card-title font-weight-bold">${data[i]["name"]}</h5>
                                        <p class="card-text regular_color">${lang.performer_name}: ${data[i]["performer"]}</p>
                                        <p class="card-text regular_color">${lang.date}: ${data[i]["date"]["year"]}/${data[i]["date"]["month"]}/${data[i]["date"]["day"]}</p>
                                        <p class="card-text regular_color">${lang.location}: ${data[i]["venue"]["name"]}, ${data[i]["venue"]["city"]}, ${data[i]["venue"]["country"]}</p>
                                    </div>
                                </div>
                                <div class="col-md-5">
                                    <div class="card-body">
                                        <p class="card-text regular_color">${lang.requested_by}: ${data[i]["request_by"]}</p>
                                        <p class="card-text regular_color">${lang.requested_on}: ${data[i]["request_on"]}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2 align-self-center">
                            <button class="${buttonStyle}" id="request_button_${data[i]["_id"]}" style="height: 75px;">${lang.view_requests_button}</button>
                        </div>
                    </div>
                </div>
            </div>
        `;
  }

  for (let i = 0; i < data.length; ++i) {

    let current_requested_id = data[i]["_id"];

    document
        .getElementById(`request_button_${data[i]["_id"]}`)
        .addEventListener("click", () => {
          data[i]["times_viewed"] = data[i]["times_viewed"] + 1;
          fetch("/selltickets/api/openrequest/", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(data[i]),
          })
              .then((response) => response.json())
              .then((answer) => {
                console.log("Success:", answer);
              })
              .catch((err) => {
                console.log(err);
              });

          fetch(`/selltickets/api/requestbyid/?id=${data[i]["_id"]}`)
              .then((response) => response.json())
              .then((concertData) => {
                fetch("/concert/api/venues/")
                    .then((response) => {
                      return response.json();
                    })
                    .then((data) => {
                      admin_content.innerHTML = `<br>
                <div class="container">
                    <div class="ticket-container">
                    <div class="ticket-info-box">
                        <h2 class="text-center concert_title attention_color font_family" style="margin-top: 0;">*${
                          lang.concert_name
                      }</h2>
                    <div class="form-group mb-3">
                        <input type="text" value="${
                          concertData["name"]
                      }" name="concertname" id="concertname" placeholder="Concert Name" class="form-control" required>
                        <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
                    </div>
                        <div class="divider dividor_color"></div>
                        <p  class="detail_list_item regular_color">*${
                          lang.poster_url
                      }:</p>
                        <div class="form-group mb-3">
                            <input type="text" value="${
                          concertData["poster"]
                      }" name="concertimageurl" id="concertimageurl" placeholder="https://i.imgur.com/y8wLfxd.jpeg" class="form-control" required>
                        </div>   
                    <div class="ticket-img-box">         
                        <img id="concertimage" src="${
                          concertData["poster"]
                      }" alt="Concert Poster" class="ticket-img img-fluid"/>
                    </div>
                    <div class="row justify-content-around">
                        <div>
                            <button class="btn button_color font_family" id="accept_request_button">${
                          lang.accept_request
                      }</button>
                            <p style="color: red;" id="global_error_message"></p>
                        </div>
                        <div>
                            <button class="btn button_color font_family" id="reject_request_button">${
                          lang.reject_request
                      }</button>
                        </div>
                    </div>
                </div>
                <div class="ticket-info-box">
                  <h2 class="text-center concert_title attention_color font_family" style="margin-top: 0;">${
                          lang.details
                      }</h2>
                  <div class="divider dividor_color"></div>
                    <br>
                    <p id="performer_name" class="detail_list_item regular_color">*${
                          lang.performer_name
                      }:</p>
                    <div class="form-group mb-3">
                        <input type="text" value="${
                          concertData["performer"]
                      }" name="performername" id="performername" placeholder=${
                          lang.performer_name
                      } class="form-control" required>
                    </div>
                    
                    <p class="detail_list_item regular_color">*${
                          lang.genre
                      }:</p>
                    <div class="form-group mb-3">
                        <select id="genrename" name="genrename" class="form-control" required>
                            <option ${
                          concertData["genre"] === "Blues" ? "selected" : ""
                      } value="Blues">${lang.genre_stuff.blues}</option>
                            <option ${
                          concertData["genre"] === "Classical"
                              ? "selected"
                              : ""
                      } value="Classical">${
                          lang.genre_stuff.classical
                      }</option>
                            <option ${
                          concertData["genre"] === "Country"
                              ? "selected"
                              : ""
                      } value="Country">${
                          lang.genre_stuff.country
                      }</option>
                            <option ${
                          concertData["genre"] === "Dance" ? "selected" : ""
                      } value="Dance">${lang.genre_stuff.dance}</option>
                            <option ${
                          concertData["genre"] === "EDM" ? "selected" : ""
                      } value="EDM">${
                          lang.genre_stuff.electronic
                      }</option>
                            <option ${
                          concertData["genre"] === "Folk" ? "selected" : ""
                      } value="Folk">${lang.genre_stuff.folk}</option>
                            <option ${
                          concertData["genre"] === "Hip-Hop"
                              ? "selected"
                              : ""
                      } value="Hip-Hop">${
                          lang.genre_stuff.hiphop
                      }</option>
                            <option ${
                          concertData["genre"] === "Jazz" ? "selected" : ""
                      } value="Jazz">${lang.genre_stuff.jazz}</option>
                            <option ${
                          concertData["genre"] === "Metal" ? "selected" : ""
                      } value="Metal">${lang.genre_stuff.metal}</option>
                            <option ${
                          concertData["genre"] === "Pop" ? "selected" : ""
                      } value="Pop">${lang.genre_stuff.pop}</option>
                            <option ${
                          concertData["genre"] === "Reggae"
                              ? "selected"
                              : ""
                      } value="Reggae">${lang.genre_stuff.reggae}</option>
                            <option ${
                          concertData["genre"] === "Rock" ? "selected" : ""
                      } value="Rock">${lang.genre_stuff.rock}</option>
                            <option ${
                          concertData["genre"] === "Soul" ? "selected" : ""
                      } value="Soul">${lang.genre_stuff.soul}</option>
                            <option ${
                          concertData["genre"] === "World" ? "selected" : ""
                      } value="World">${
                          lang.genre_stuff.world
                      }</option>          
                        </select>
                    </div>
                                                       
                    <p id="age_toattend" class="detail_list_item regular_color">*${
                          lang.age_to_attend
                      }:</p>
                    <div class="form-group mb-3">
                        <input type="number" value="${
                          concertData["age_to_attend"]
                      }" name="agetoattend" id="agetoattend" placeholder=${
                          lang.enter_age
                      } class="form-control" required>
                        <div><small id="age_to_attend_error" class="font_family" style="color: red;"></small></div>
                    </div>               
                    
                    
                    <p id="dateofconcert" class="detail_list_item regular_color">*${
                          lang.date
                      }:
                    </p>
                    <div class="form-group mb-3">
                        <input type="date" value="${
                          concertData["date"]["year"]
                      }-${
                          concertData["date"]["month"] < 10
                              ? "0" + concertData["date"]["month"]
                              : concertData["date"]["month"]
                      }-${
                          concertData["date"]["day"] < 10
                              ? "0" + concertData["date"]["day"]
                              : concertData["date"]["day"]
                      }" class="form-control mr-3" id="concertdate">
                    </div>  
                    
                    
                    <p id="concertstarttime" class="detail_list_item regular_color">*${
                          lang.doors_open
                      }:</p>
                    <div class="form-group mb-3">
                        <input type="text" value="${
                          concertData["time"]["start"]
                      }" name="concertdoorsopen" id="concertdoorsopen" placeholder="18:30" class="form-control" required>
                        <div><small id="doors_open_error" class="font_family" style="color: red;"></small></div>
                    </div>
                    
                    
                    <p id="concertendtime" class="detail_list_item regular_color">*${
                          lang.doors_close
                      }:</p>
                    <div class="form-group mb-3">
                        <input type="text" value="${
                          concertData["time"]["end"]
                      }" name="concertdoorsclose" id="concertdoorsclose" placeholder="20:30" class="form-control" required>
                        <div><small id="doors_close_error" class="font_family" style="color: red;"></small></div>
                    </div>    
                             
                    <div class="form-group form-check d-flex align-items-center regular_color">
                        <label class="mb-0">
                            <input id="disability_access" ${
                          concertData["disability_accessible"]
                              ? "checked"
                              : ""
                      } type="checkbox" class="form-check-input mr-2">${
                          lang.disability_access
                      }
                        </label>
                    </div>
        
                    <div class="form-group form-check d-flex align-items-center regular_color">
                        <label class="mb-0">
                            <input id="deal" ${
                          concertData["deal"] ? "checked" : ""
                      } type="checkbox" class="form-check-input mr-2">${
                          lang.deal
                      }
                        </label>
                    </div>
                    
                    
                    
                    
                
                    <p id="venue_name" class="detail_list_item regular_color">*${
                          lang.venue_name
                      }:</p>
                    <div class="form-group mb-3">
                        <select id="venuename" name="venuename" class="form-control" required>
                        <option selected disabled value="${
                          concertData["venue"]["name"]
                      }">${concertData["venue"]["name"]}</option>
                    </select>        
                    `;

                      admin_content.innerHTML += `
                              <p id="venue_address" class="detail_list_item regular_color">${lang.venue_address}:</p>
                              <div class="form-group mb-3">
                                  <input type="text" value="${concertData["venue"]["address"]}" name="venueaddress" value="" id="venueaddress" class="form-control" required readonly>
                                  <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
                              </div>
                  
                  
                  
                              <p id="concertcity" class="detail_list_item regular_color">${lang.city}:</p>
                              <div class="form-group mb-3">
                                  <input type="text" value="${concertData["venue"]["city"]}" name="venuecity" readonly id="venuecity" value="" class="form-control" required>
                                  <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
                              </div>
                  
                              <p id="concertcountry" class="detail_list_item regular_color">${lang.country}:</p>
                              <div class="form-group mb-3">
                                  <input type="text" value="${concertData["venue"]["country"]}" name="venuecountry" id="venuecountry" value="" class="form-control" required>
                                  <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
                              </div>
                                                     
                                      <div class="form-group mb-3"> 
                                      <p id="seatingarrangement" class="detail_list_item regular_color">${lang.seats}:</p>  
                               <table class="table">
                                  <thead class="thead-dark">
                                      <tr>
                                          <th scope="col" class="regular_color">*${lang.seat_type}</th>
                                          <th scope="col" class="regular_color">*${lang.total_amount}</th>
                                          <th scope="col" class="regular_color">*${lang.amount_to_reserve}</th>
                                          <th scope="col" class="regular_color">*${lang.price_per_seat}</th>
                                      </tr>
                                  </thead>
                                  <tbody id="seattable">
                                  </tbody>
                               </table>          
                              </div>
                                <p id="tickets_available" class="detail_list_item regular_color">${lang.tickets_available}:</p>
                                    <div class="form-group mb-3">
                                    <input type="number" value="${concertData["tickets_available"]}" name="ticketsavailable" id="ticketsavailable" placeholder="0" class="form-control" required>
                                    <div><small id="usernameerror" class="font_family" style="color: red;"></small></div>
                                    </div>                         
                              <br>`;
                      return data;
                    })
                    .then((data) => {
                      document
                          .getElementById("concertdoorsopen")
                          .addEventListener("change", () => {
                            if (
                                !isMilitaryTime(
                                    document.getElementById("concertdoorsopen").value
                                )
                            ) {
                              document.getElementById(
                                  "doors_open_error"
                              ).innerText = `*${lang.time_format_error}`;
                            } else {
                              document.getElementById("doors_open_error").innerText =
                                  "";
                            }
                          });

                      document
                          .getElementById("concertdoorsclose")
                          .addEventListener("change", () => {
                            if (
                                !isMilitaryTime(
                                    document.getElementById("concertdoorsclose").value
                                )
                            ) {
                              document.getElementById(
                                  "doors_close_error"
                              ).innerText = `*${lang.time_format_error}`;
                            } else {
                              document.getElementById("doors_close_error").innerText =
                                  "";
                            }
                          });

                      document
                          .getElementById("agetoattend")
                          .addEventListener("change", () => {
                            if (+document.getElementById("agetoattend").value < 0) {
                              document.getElementById(
                                  "age_to_attend_error"
                              ).innerText = `*${lang.age_to_attend_error}`;
                            } else {
                              document.getElementById("age_to_attend_error").innerText =
                                  "";
                            }
                          });

                      for (let i = 0; i < data.length; ++i) {
                        if (data[i]["name"] === concertData["venue"]["name"]) {
                          document.getElementById("venueaddress").value =
                              data[i]["address"];
                          document.getElementById("venuecity").value =
                              data[i]["city"];
                          document.getElementById("venuecountry").value =
                              data[i]["country"];
                          document.getElementById("seattable").innerHTML = "";
                          for (let j = 0; j < data[i]["seating"].length; ++j) {
                            document.getElementById("seattable").innerHTML += `
                                                       <tr class="regular_color">
                                                          <th scope="row">${data[i]["seating"][j]["type"]}</th>
                                                          <td>${data[i]["seating"][j]["total"]}</td>
                                                          <td><input type="number" value="${concertData["venue"]["seating"][j]["available_for_booking"]}" min="0" name="${data[i]["seating"][j]["type"]}number" id="${data[i]["seating"][j]["type"]}number"  class="form-control" required placeholder="0"></td>
                                                          <td><input type="number" value="${concertData["venue"]["seating"][j]["price"]}" min="0" name="${data[i]["seating"][j]["type"]}price" id="${data[i]["seating"][j]["type"]}price" class="form-control" required placeholder="0.0"></td>
                                                      </tr>                  
                                                    `;
                          }

                          for (let j = 0; j < data[i]["seating"].length; ++j) {
                            let tickets_available =
                                document.getElementById("ticketsavailable");
                            let seat_number = document.getElementById(
                                `${data[i]["seating"][j]["type"]}number`
                            );

                            seat_number.addEventListener("change", () => {
                              let total = 0;

                              for (let k = 0; k < data[i]["seating"].length; ++k) {
                                let number_of_seats = document.getElementById(
                                    `${data[i]["seating"][k]["type"]}number`
                                );

                                if (number_of_seats.value < 0) {
                                  number_of_seats.value = 0;
                                }

                                if (
                                    number_of_seats.value >
                                    data[i]["seating"][k]["total"]
                                ) {
                                  number_of_seats.value =
                                      data[i]["seating"][k]["total"];
                                }
                                total += +number_of_seats.value;
                              }

                              if (total > data[i]["seat_count_total"]) {
                                tickets_available.value = data[i]["seat_count_total"];
                              } else {
                                tickets_available.value = total;
                              }
                            });
                          }
                        }
                      }

                      document
                          .getElementById("concertimageurl")
                          .addEventListener("change", () => {
                            let the_url =
                                document.getElementById("concertimageurl").value;
                            let concert_poster =
                                document.getElementById("concertimage");

                            if (
                                the_url !== "" &&
                                (the_url.endsWith(".jpeg") ||
                                    the_url.endsWith(".gif") ||
                                    the_url.endsWith(".png") ||
                                    the_url.endsWith(".apng") ||
                                    the_url.endsWith(".svg") ||
                                    the_url.endsWith(".bmp") ||
                                    the_url.endsWith(".jpg"))
                            ) {
                              concert_poster.src = the_url;
                            } else {
                              concert_poster.src =
                                  "https://via.placeholder.com/450x300";
                            }
                          });

                      // Create button event listener --ACCEPT REQUEST
                      document
                          .getElementById("accept_request_button")
                          .addEventListener("click", () => {
                            let concertname =
                                document.getElementById("concertname").value;
                            let posterurl =
                                document.getElementById("concertimageurl").value;
                            let performer_name =
                                document.getElementById("performername").value;
                            let age_to_attend =
                                document.getElementById("agetoattend").value;
                            const date = new Date(
                                document.getElementById("concertdate").value
                            );

                            let year = date.getFullYear();
                            let month = date.getMonth() + 1;
                            let day = date.getDate() + 1;

                            let concert_start_time =
                                document.getElementById("concertdoorsopen").value;
                            let concert_end_time =
                                document.getElementById("concertdoorsclose").value;
                            let venue_name =
                                document.getElementById("venuename").selectedOptions[0]
                                    .value;
                            let tickets_available =
                                document.getElementById("ticketsavailable").value;

                            let genre =
                                document.getElementById("genrename").selectedOptions[0]
                                    .value;

                            // returns bool
                            let disability_access =
                                document.getElementById("disability_access").checked;

                            let deal = document.getElementById("deal").checked;

                            let sold_tickets = 0;

                            let times_viewed = 0;
                            let venue = {};

                            if (
                                concertname !== "" &&
                                posterurl !== "" &&
                                performer_name !== "" &&
                                age_to_attend &&
                                age_to_attend > 0 &&
                                year &&
                                month &&
                                day &&
                                concert_start_time &&
                                concert_end_time &&
                                venue_name !== "#" &&
                                tickets_available &&
                                genre !== "#"
                            ) {
                              for (let i = 0; i < data.length; ++i) {
                                if (data[i]["name"] === venue_name) {
                                  venue = data[i];
                                  break;
                                }
                              }

                              let price_list = [];

                              for (let i = 0; i < venue["seating"].length; ++i) {
                                venue["seating"][i]["price"] = +document.getElementById(
                                    `${venue["seating"][i]["type"]}price`
                                ).value;
                                price_list.push(venue["seating"][i]["price"]);

                                venue["seating"][i]["available"] =
                                    +document.getElementById(
                                        `${venue["seating"][i]["type"]}number`
                                    ).value;
                                venue["seating"][i]["available_for_booking"] =
                                    +document.getElementById(
                                        `${venue["seating"][i]["type"]}number`
                                    ).value; ////////

                                venue["seating"][i]["sold"] = 0;
                                venue["seating"][i]["seats"] = [];

                                for (
                                    let j = 0;
                                    j < venue["seating"][i]["available_for_booking"];
                                    ++j
                                ) {
                                  venue["seating"][i]["seats"].push({
                                    id: j + 1,
                                    vacant: true,
                                  });
                                }
                              }

                              let cheapest_seat = Math.min(...price_list);

                              venue["cheapest_seat"] = cheapest_seat;

                              if (cheapest_seat !== 0) {
                                // Creating giga concert object
                                fetch("/concert/api/nextconcertid/")
                                    .then((response) => {
                                      return response.json();
                                    })
                                    .then((data) => {
                                      let concert = {
                                        _id: data["_id"],
                                        name: concertname,
                                        poster: posterurl,
                                        performer: performer_name,
                                        sold_tickets: sold_tickets,
                                        times_viewed: times_viewed,
                                        genre: genre,
                                        tickets_available: +tickets_available,
                                        age_to_attend: +age_to_attend,
                                        disability_accessible: disability_access,
                                        deal: deal,
                                        date: {
                                          year: year,
                                          month: month,
                                          day: day,
                                        },
                                        time: {
                                          start: concert_start_time,
                                          end: concert_end_time,
                                        },
                                        venue: venue,
                                      };

                                      fetch("/concert/api/createconcert/", {
                                        method: "POST",
                                        headers: {
                                          "Content-Type": "application/json",
                                        },
                                        body: JSON.stringify(concert),
                                      })
                                          .then((response) => {
                                            return response.json();
                                          })
                                          .then((data) => {
                                            admin_content.innerHTML = `<div class="ticket-info-box">
                                                                <h2 class="text-center attention_color" style="margin-top: 0;" id="concertname">Concert Accepted</h2>
                                                                    </div>
                                                                `;
                                          })
                                          .catch((error) => {
                                            console.log(error);
                                          });

                                      fetch(
                                          `/selltickets/api/deleterequest/?id=${current_requested_id}`,
                                          {
                                            method: "POST",
                                            headers: {
                                              "Content-Type": "application/json",
                                            },
                                            body: JSON.stringify(current_requested_id),
                                          }
                                      )
                                          .then((response) => response.json())
                                          .then(() => {
                                            console.log("request removed");
                                          })
                                          .catch((err) => {
                                            console.log(err);
                                          });
                                    })
                                    .catch((err) => {
                                      console.log(err);
                                    });
                              } else {
                                document.getElementById(
                                    "global_error_message"
                                ).innerText = "A ticket price cannot be 0";
                              }
                            } else {
                              document.getElementById(
                                  "global_error_message"
                              ).innerText =
                                  "Please fill out all the required fields that begin with *";
                            }
                            // console.log(JSON.stringify(concert));
                          });

                      // Create button event listener --REJECT REQUEST
                      document
                          .getElementById("reject_request_button")
                          .addEventListener("click", () => {
                            fetch(
                                `/selltickets/api/deleterequest/?id=${current_requested_id}`,
                                {
                                  method: "POST",
                                  headers: {
                                    "Content-Type": "application/json",
                                  },
                                  body: JSON.stringify(current_requested_id),
                                }
                            )
                                .then((response) => response.json())
                                .then((data) => {
                                  admin_content.innerHTML = `
                                                    <div class="ticket-info-box">
                                                        <h2 class="text-center attention_color" style="margin-top: 0;" id="concertname">${data["message"]}</h2>
                                                    </div>
                                                `;
                                })
                                .catch((err) => {
                                  console.log(err);
                                });
                          });
                    })
                    .catch((err) => {
                      console.log(err);
                    });
                /////////////////////////////////////
              })
              .catch((err) => {
                console.log(err);
              });
        });
  }
}

document.getElementById("viewrequestsbutton").addEventListener("click", () => {
  let lang = translation(dictionary);

  createLoadingCoverForElement(admin_content);
  activateLoadingCoverForElement(admin_content);

  fetch("/selltickets/api/allrequests")
      .then((res) => res.json())
      .then((data) => {
        if (data.length === 0) {
          admin_content.innerHTML = `
                <br>
                <h1 class="text-center attention_color">${lang.no_requests_found}</h1>
                <br>`;
          disableLoadingCoverForElement(admin_content);
        } else {
          admin_content.innerHTML = `
                <br>
                <h1 class="text-center attention_color">${lang.requests}</h1>
                <br>
            
                <div class="container-fluid justify-content-center">
                    <div class="row justify-content-center">
                        <div class="col-12 justify-content-center" id="cards_container">
                        </div>
                    </div>
                </div>`;
          generateRequestCards(data);
          disableLoadingCoverForElement(admin_content);
        }
      });
});


function checkSeatCount(event) {
  let lang = translation(dictionary);
  // Get reference to the seatcount input field
  const seatcountInput = event.target;

  // Check if the value is greater than 30
  if (seatcountInput.value > MAX_SEAT_PER_ROW || seatcountInput.value < 0) {
    VENUE_GOOD = false;
    // Create a new div with the error message
    const errorMessageDiv = document.createElement('div');
    const errorMessage = document.createElement('small');
    errorMessage.classList.add('font_family');
    errorMessage.style.color = 'red';
    errorMessage.textContent = lang.seat_count_error;

    // Add the error message to the new div
    errorMessageDiv.appendChild(errorMessage);

    // Insert the new div after the input field
    seatcountInput.insertAdjacentElement('afterend', errorMessageDiv);

    // Add a change event listener to the input field to remove the error message when the value is changed again
    seatcountInput.addEventListener('change', function () {
      // Remove the error message and the new div
      errorMessageDiv.remove();
      this.removeEventListener('change', arguments.callee);
      VENUE_GOOD = true;
    });
  }
  console.log(VENUE_GOOD);
}

function aRow() {
  let lang = translation(dictionary);
  ++ROW_COUNT;
  return `<div class="form-group">
                  <label for="seatcount" class="regular_color font_family">${lang.row} ${ROW_COUNT}:</label>
                  <input type="number" name="seatcount" id="row${ROW_COUNT}"  class="form-control" placeholder="${lang.seat_count}" onchange="checkSeatCount(event)" required>
          </div>`;
}

function aSeatType(inc = true) {
  let lang = translation(dictionary);
  if (inc) {
    ++TYPE_COUNT;
  }
  return `<div class="type${TYPE_COUNT} border_color_second m-4" id="type${TYPE_COUNT}_seats">
              <div class="m-3">    
                  <div class="form-group">
                      <label for="seattype" class="regular_color font_family">${lang.seat_type}:</label>
                      <input type="text" id="type${TYPE_COUNT}" class="form-control" placeholder="${lang.seat_type}" required>
                  </div>
                  <div class="d-flex align-items-center justify-content-center">
                      <button id="type${TYPE_COUNT}addnewrow" class="btn btn-sm button_color font_family d-flex justify-content-center" style="width: 160px;">${lang.add_a_row}</button> &nbsp;
                      <button id="type${TYPE_COUNT}removearow" class="btn btn-sm button_color font_family d-flex justify-content-center" style="width: 160px;">${lang.remove_a_row}</button>
                  </div>
          
                  <div class="type${TYPE_COUNT}_rows">
                      <!--new row is added here-->
                  </div>
              </div>
         </div>`;
}


function lockPrevSeatType(stat) {
  if (TYPE_COUNT > 0) {
    const myDiv = document.getElementById(`type${TYPE_COUNT}_seats`);
    const inputs = myDiv.querySelectorAll('input, button');

    // Loop through the inputs and disable them
    inputs.forEach(input => {
      if (input.tagName === 'BUTTON') {
        if (stat === true) {
          input.setAttribute("disabled", "true");
        } else {
          input.removeAttribute("disabled");
        }

      }
      input.readOnly = stat;
    });
  }
}

function loadModal(message) {
  var modalBody = document.getElementById("message");
  modalBody.innerHTML = message;

  let myModal = new bootstrap.Modal(document.getElementById("messageModal"), {
    backdrop: "static",
    keyboard: true,
    focus: true,
  });

  myModal.show();
}


function checkSeatType() {

  if (TYPE_COUNT > 0) {
    let notempty = true;
    const myDiv = document.getElementById(`type${TYPE_COUNT}_seats`);
    const inputs = myDiv.querySelectorAll('input, button');

    inputs.forEach(input => {
      if (input.tagName === 'INPUT' && input.value === "") {
        notempty = false;
      }
    });
    return notempty;
  } else {
    return true;
  }

}

document.getElementById("createvenuebutton").addEventListener("click", () => {
  let lang = translation(dictionary);
  TYPE_COUNT = 0;
  ROW_COUNT = 0;
  VENUE_GOOD = true;

  admin_content.innerHTML =
      `
      <br>
      <hr>
      <div class="container">
          <div class="divider dividor_color"></div>
          <div class="form-group">
              <label for="name" class = "regular_color font_family">${lang.venue_name}:</label><br>
              <input type="text" id="name" class="form-control" placeholder=${lang.venue_name} required>
          </div>
          <div class="form-group mb-3">
              <label for="country" class = "regular_color font_family">${lang.country}:</label><br>
              <select id="country" name="country" class="form-control" required>
                  <option selected disabled value="#">${lang.select_country}</option>
                  <option value="AFN">Afghanistan</option>
                  <option value="EUR">Aland Islands</option>
                  <option value="ALL">Albania</option>
                  <option value="DZD">Algeria</option>
                  <option value="USD">American Samoa</option>
                  <option value="EUR">Andorra</option>
                  <option value="AOA">Angola</option>
                  <option value="XCD">Anguilla</option>
                  <option value="AAD">Antarctica</option>
                  <option value="XCD">Antigua & Barbuda</option>
                  <option value="ARS">Argentina</option>
                  <option value="AMD">Armenia</option>
                  <option value="AWG">Aruba</option>
                  <option value="AUD">Australia</option>
                  <option value="EUR">Austria</option>
                  <option value="AZN">Azerbaijan</option>
                  <option value="BSD">Bahamas</option>
                  <option value="BHD">Bahrain</option>
                  <option value="BDT">Bangladesh</option>
                  <option value="BBD">Barbados</option>
                  <option value="BYN">Belarus</option>
                  <option value="EUR">Belgium</option>
                  <option value="BZD">Belize</option>
                  <option value="XOF">Benin</option>
                  <option value="BMD">Bermuda</option>
                  <option value="BTN">Bhutan</option>
                  <option value="BOB">Bolivia</option>
                  <option value="USD">Caribbean Netherlands</option>
                  <option value="BAM">Bosnia & Herzegovina</option>
                  <option value="BWP">Botswana</option>
                  <option value="NOK">Bouvet Island</option>
                  <option value="BRL">Brazil</option>
                  <option value="USD">British Indian Ocean Territory</option>
                  <option value="BND">Brunei</option>
                  <option value="BGN">Bulgaria</option>
                  <option value="XOF">Burkina Faso</option>
                  <option value="BIF">Burundi</option>
                  <option value="KHR">Cambodia</option>
                  <option value="XAF">Cameroon</option>
                  <option value="CAD">Canada</option>
                  <option value="CVE">Cape Verde</option>
                  <option value="KYD">Cayman Islands</option>
                  <option value="XAF">Central African Republic</option>
                  <option value="XAF">Chad</option>
                  <option value="CLP">Chile</option>
                  <option value="CNY">China</option>
                  <option value="AUD">Christmas Island</option>
                  <option value="AUD">Cocos (Keeling) Islands</option>
                  <option value="COP">Colombia</option>
                  <option value="KMF">Comoros</option>
                  <option value="XAF">Congo - Brazzaville</option>
                  <option value="CDF">Congo - Kinshasa</option>
                  <option value="NZD">Cook Islands</option>
                  <option value="CRC">Costa Rica</option>
                  <option value="XOF">Côte d’Ivoire</option>
                  <option value="HRK">Croatia</option>
                  <option value="CUP">Cuba</option>
                  <option value="ANG">Curaçao</option>
                  <option value="EUR">Cyprus</option>
                  <option value="CZK">Czechia</option>
                  <option value="DKK">Denmark</option>
                  <option value="DJF">Djibouti</option>
                  <option value="XCD">Dominica</option>
                  <option value="DOP">Dominican Republic</option>
                  <option value="USD">Ecuador</option>
                  <option value="EGP">Egypt</option>
                  <option value="USD">El Salvador</option>
                  <option value="XAF">Equatorial Guinea</option>
                  <option value="ERN">Eritrea</option>
                  <option value="EUR">Estonia</option>
                  <option value="ETB">Ethiopia</option>
                  <option value="FKP">Falkland Islands (Islas Malvinas)</option>
                  <option value="DKK">Faroe Islands</option>
                  <option value="FJD">Fiji</option>
                  <option value="EUR">Finland</option>
                  <option value="EUR">France</option>
                  <option value="EUR">French Guiana</option>
                  <option value="XPF">French Polynesia</option>
                  <option value="EUR">French Southern Territories</option>
                  <option value="XAF">Gabon</option>
                  <option value="GMD">Gambia</option>
                  <option value="GEL">Georgia</option>
                  <option value="EUR">Germany</option>
                  <option value="GHS">Ghana</option>
                  <option value="GIP">Gibraltar</option>
                  <option value="EUR">Greece</option>
                  <option value="DKK">Greenland</option>
                  <option value="XCD">Grenada</option>
                  <option value="EUR">Guadeloupe</option>
                  <option value="USD">Guam</option>
                  <option value="GTQ">Guatemala</option>
                  <option value="GBP">Guernsey</option>
                  <option value="GNF">Guinea</option>
                  <option value="XOF">Guinea-Bissau</option>
                  <option value="GYD">Guyana</option>
                  <option value="HTG">Haiti</option>
                  <option value="AUD">Heard & McDonald Islands</option>
                  <option value="EUR">Vatican City</option>
                  <option value="HNL">Honduras</option>
                  <option value="HKD">Hong Kong</option>
                  <option value="HUF">Hungary</option>
                  <option value="ISK">Iceland</option>
                  <option value="INR">India</option>
                  <option value="IDR">Indonesia</option>
                  <option value="IRR">Iran</option>
                  <option value="IQD">Iraq</option>
                  <option value="EUR">Ireland</option>
                  <option value="GBP">Isle of Man</option>
                  <option value="ILS">Israel</option>
                  <option value="EUR">Italy</option>
                  <option value="JMD">Jamaica</option>
                  <option value="JPY">Japan</option>
                  <option value="GBP">Jersey</option>
                  <option value="JOD">Jordan</option>
                  <option value="KZT">Kazakhstan</option>
                  <option value="KES">Kenya</option>
                  <option value="AUD">Kiribati</option>
                  <option value="KPW">North Korea</option>
                  <option value="KRW">South Korea</option>
                  <option value="EUR">Kosovo</option>
                  <option value="KWD">Kuwait</option>
                  <option value="KGS">Kyrgyzstan</option>
                  <option value="LAK">Laos</option>
                  <option value="EUR">Latvia</option>
                  <option value="LBP">Lebanon</option>
                  <option value="LSL">Lesotho</option>
                  <option value="LRD">Liberia</option>
                  <option value="LYD">Libya</option>
                  <option value="CHF">Liechtenstein</option>
                  <option value="EUR">Lithuania</option>
                  <option value="EUR">Luxembourg</option>
                  <option value="MOP">Macao</option>
                  <option value="MKD">North Macedonia</option>
                  <option value="MGA">Madagascar</option>
                  <option value="MWK">Malawi</option>
                  <option value="MYR">Malaysia</option>
                  <option value="MVR">Maldives</option>
                  <option value="XOF">Mali</option>
                  <option value="EUR">Malta</option>
                  <option value="USD">Marshall Islands</option>
                  <option value="EUR">Martinique</option>
                  <option value="MRO">Mauritania</option>
                  <option value="MUR">Mauritius</option>
                  <option value="EUR">Mayotte</option>
                  <option value="MXN">Mexico</option>
                  <option value="USD">Micronesia</option>
                  <option value="MDL">Moldova</option>
                  <option value="EUR">Monaco</option>
                  <option value="MNT">Mongolia</option>
                  <option value="EUR">Montenegro</option>
                  <option value="XCD">Montserrat</option>
                  <option value="MAD">Morocco</option>
                  <option value="MZN">Mozambique</option>
                  <option value="MMK">Myanmar (Burma)</option>
                  <option value="NAD">Namibia</option>
                  <option value="AUD">Nauru</option>
                  <option value="NPR">Nepal</option>
                  <option value="EUR">Netherlands</option>
                  <option value="ANG">Curaçao</option>
                  <option value="XPF">New Caledonia</option>
                  <option value="NZD">New Zealand</option>
                  <option value="NIO">Nicaragua</option>
                  <option value="XOF">Niger</option>
                  <option value="NGN">Nigeria</option>
                  <option value="NZD">Niue</option>
                  <option value="AUD">Norfolk Island</option>
                  <option value="USD">Northern Mariana Islands</option>
                  <option value="NOK">Norway</option>
                  <option value="OMR">Oman</option>
                  <option value="PKR">Pakistan</option>
                  <option value="USD">Palau</option>
                  <option value="ILS">Palestine</option>
                  <option value="PAB">Panama</option>
                  <option value="PGK">Papua New Guinea</option>
                  <option value="PYG">Paraguay</option>
                  <option value="PEN">Peru</option>
                  <option value="PHP">Philippines</option>
                  <option value="NZD">Pitcairn Islands</option>
                  <option value="PLN">Poland</option>
                  <option value="EUR">Portugal</option>
                  <option value="USD">Puerto Rico</option>
                  <option value="QAR">Qatar</option>
                  <option value="EUR">Réunion</option>
                  <option value="RON">Romania</option>
                  <option value="RUB">Russia</option>
                  <option value="RWF">Rwanda</option>
                  <option value="EUR">St. Barthélemy</option>
                  <option value="SHP">St. Helena</option>
                  <option value="XCD">St. Kitts & Nevis</option>
                  <option value="XCD">St. Lucia</option>
                  <option value="EUR">St. Martin</option>
                  <option value="EUR">St. Pierre & Miquelon</option>
                  <option value="XCD">St. Vincent & Grenadines</option>
                  <option value="WST">Samoa</option>
                  <option value="EUR">San Marino</option>
                  <option value="STD">São Tomé & Príncipe</option>
                  <option value="SAR">Saudi Arabia</option>
                  <option value="XOF">Senegal</option>
                  <option value="RSD">Serbia</option>
                  <option value="RSD">Serbia</option>
                  <option value="SCR">Seychelles</option>
                  <option value="SLL">Sierra Leone</option>
                  <option value="SGD">Singapore</option>
                  <option value="ANG">Sint Maarten</option>
                  <option value="EUR">Slovakia</option>
                  <option value="EUR">Slovenia</option>
                  <option value="SBD">Solomon Islands</option>
                  <option value="SOS">Somalia</option>
                  <option value="ZAR">South Africa</option>
                  <option value="GBP">South Georgia & South Sandwich Islands</option>
                  <option value="SSP">South Sudan</option>
                  <option value="EUR">Spain</option>
                  <option value="LKR">Sri Lanka</option>
                  <option value="SDG">Sudan</option>
                  <option value="SRD">Suriname</option>
                  <option value="NOK">Svalbard & Jan Mayen</option>
                  <option value="SZL">Eswatini</option>
                  <option value="SEK">Sweden</option>
                  <option value="CHF">Switzerland</option>
                  <option value="SYP">Syria</option>
                  <option value="TWD">Taiwan</option>
                  <option value="TJS">Tajikistan</option>
                  <option value="TZS">Tanzania</option>
                  <option value="THB">Thailand</option>
                  <option value="USD">Timor-Leste</option>
                  <option value="XOF">Togo</option>
                  <option value="NZD">Tokelau</option>
                  <option value="TOP">Tonga</option>
                  <option value="TTD">Trinidad & Tobago</option>
                  <option value="TND">Tunisia</option>
                  <option value="TRY">Turkey</option>
                  <option value="TMT">Turkmenistan</option>
                  <option value="USD">Turks & Caicos Islands</option>
                  <option value="AUD">Tuvalu</option>
                  <option value="UGX">Uganda</option>
                  <option value="UAH">Ukraine</option>
                  <option value="AED">United Arab Emirates</option>
                  <option value="GBP">United Kingdom</option>
                  <option value="USD">United States</option>
                  <option value="USD">U.S. Outlying Islands</option>
                  <option value="UYU">Uruguay</option>
                  <option value="UZS">Uzbekistan</option>
                  <option value="VUV">Vanuatu</option>
                  <option value="VEF">Venezuela</option>
                  <option value="VND">Vietnam</option>
                  <option value="USD">British Virgin Islands</option>
                  <option value="USD">U.S. Virgin Islands</option>
                  <option value="XPF">Wallis & Futuna</option>
                  <option value="MAD">Western Sahara</option>
                  <option value="YER">Yemen</option>
                  <option value="ZMW">Zambia</option>
                  <option value="ZWL">Zimbabwe</option>
              </select>
          </div>
  
          <div class="form-group mb-3">
              <label for="city" class = "regular_color font_family">${lang.city}:</label><br>
              <input type="text" id="city" class="form-control" placeholder=${lang.city} required>
          </div>
          <div class="form-group mb-3">
              <label for="address" class = "regular_color font_family">${lang.address}:</label><br>
              <input type="text" id="address" class="form-control" placeholder=${lang.address} required>
          </div>
          <br>
          <div class="seats border_color_second">
              <!--new seat types is added here-->
          </div>
          <br>
          <div class="d-flex align-items-center justify-content-end seat_button">
              <button id="addnewseattype" class="btn btn-sm button_color font_family d-flex justify-content-center" style="width: 300px;">${lang.add_a_new_type}</button> &nbsp;
              <button id="removelastseattype" class="btn btn-sm button_color font_family d-flex justify-content-center" style="width: 300px;">${lang.remove_a_new_type}</button>
          </div>   
          <div class="d-flex align-items-center justify-content-end">
              <button type="submit" id="submit" class="btn btn-sm button_color font_family d-flex justify-content-center" style="width: 300px;">${lang.create_venue}</button>
          </div>               
      </div>        
  `;

  const addSeatTypeButton = document.getElementById("addnewseattype");
  const removeSeatTypeButton = document.getElementById("removelastseattype");
  const seatsDiv = document.querySelector(".seats");

  // add new seat type
  addSeatTypeButton.addEventListener("click", () => {
    if (checkSeatType() === true && VENUE_GOOD)
        // if(true)
    {
      lockPrevSeatType(true)
      const newSeatType = document.createElement("div");
      newSeatType.innerHTML = `${aSeatType()}`;

      // add seat type to dom
      seatsDiv.appendChild(newSeatType);


      // add row eventlisteners
      const addrowbutton = document.getElementById(`type${TYPE_COUNT}addnewrow`);
      const removerowbutton = document.getElementById(`type${TYPE_COUNT}removearow`);
      const seatsrows = document.querySelector(`.type${TYPE_COUNT}_rows`);

      addrowbutton.addEventListener("click", () => {
        const newrow = document.createElement("div");
        newrow.innerHTML = `${aRow()}`;

        seatsrows.appendChild(newrow);
      });

      removerowbutton.addEventListener("click", () => {
        const allrows = seatsrows.querySelectorAll(`.type${TYPE_COUNT}_rows > div`);
        if (allrows.length > 1) {
          --ROW_COUNT;
          seatsrows.removeChild(allrows[allrows.length - 1]);
        }
      })


      // create a row
      addrowbutton.click();


    } else {
      loadModal("Check all previous input");
    }
  });

  // remove last seat type
  removeSeatTypeButton.addEventListener("click", () => {
    const seatTypes = seatsDiv.querySelectorAll(".seats > div");
    if (seatTypes.length > 1) {
      --TYPE_COUNT;
      --ROW_COUNT;
      lockPrevSeatType(false);
      seatsDiv.removeChild(seatTypes[seatTypes.length - 1]);
    }
  });

  addSeatTypeButton.click();

  // submit
  const submit = document.getElementById("submit");
  submit.addEventListener("click", () => {
    event.preventDefault();
    let name = document.getElementById("name").value;
    let countrySelect = document.getElementById("country");
    let country = countrySelect.options[countrySelect.selectedIndex].text;
    let city = document.getElementById("city").value;
    let address = document.getElementById("address").value;

    if (checkSeatType() && VENUE_GOOD && name !== "" && country !== "" && city !== "" && address !== "") {
      let seat_count_total = 0;
      let seating = [];

      let rowcount = 0;
      const seatTypes = seatsDiv.querySelectorAll(".seats > div");
      for (let i = 1; i <= seatTypes.length; ++i) {
        let elem = {};
        elem.type = document.getElementById(`type${i}`).value;
        elem.total = 0;
        elem.layout = [];
        let rowsForThisType = document.querySelector(`.type${i}_rows`).querySelectorAll(`.type${i}_rows > div`);
        for (let j = 0; j < rowsForThisType.length; ++j) {
          ++rowcount;
          elem.total += parseInt(document.getElementById(`row${rowcount}`).value);
          let row = {
            row_num: rowcount,
            seats_per_row: parseInt(document.getElementById(`row${rowcount}`).value)
          }

          elem.layout.push(row);
        }
        seat_count_total += elem.total;
        seating.push(elem);
      }

      createLoadingCoverForElement(admin_content);
      activateLoadingCoverForElement(admin_content);
      fetch(`/concert/api/nextvenueid/`)
          .then((response) => {
            return response.json()
          })
          .then((data) => {
            let venue = {
              _id: data["_id"],
              name: name,
              country: country,
              city: city,
              address: address,
              seat_count_total: seat_count_total,
              seating: seating,
            };
            console.log(venue);

            fetch("/concert/api/createvenue/", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(venue),
            })
                .then((response) => {
                  return response.json();
                })
                .then((data) => {
                  disableLoadingCoverForElement(admin_content);
                  if (data["message"] === "venue created") {
                    document.getElementById("createvenuebutton").click();
                    loadModal("Venue created");
                  } else {
                    document.getElementById("createvenuebutton").click();
                    loadModal("Unable to create a venue");
                  }
                })
                .catch((error) => {
                  console.log(error);
                });
          })
          .catch((error) => {
            console.log(error);
          });
    } else {
      loadModal("Check all previous input");
    }
  });
})


document.getElementById("updatevenuebutton").addEventListener("click", () => {
  let lang = translation(dictionary);
  TYPE_COUNT = 0;
  ROW_COUNT = 0;
  VENUE_GOOD = true;
  admin_content.innerHTML = `
  <div class="container">
          <div class="divider dividor_color"></div>
              <p  class="detail_list_item regular_color">${lang.enter_vid_update}:</p>
          <div class="form-group mb-3">
              <input type="number" name="venue_search" id="venue_search" placeholder="1" class="form-control" required>
          </div> 
          <button class="btn button_color font_family" id="venue_search_button">${lang.search_button}</button>
          <p style="color: red;" id="global_error_message"></p>
  </div>        
  `;

  document.getElementById("venue_search_button")
      .addEventListener("click", () => {
        createLoadingCoverForElement(admin_content);
        activateLoadingCoverForElement(admin_content);
        fetch(`/concert/api/venuebyid/?id=${+document.getElementById("venue_search").value}`)
            .then((response) => response.json())
            .then((venuedata) => {
              disableLoadingCoverForElement(admin_content);
              if (venuedata["message"]) {
                document.getElementById("global_error_message").innerText = lang.venue_not_found;
              } else {
                //generate the form
                admin_content.innerHTML = `
                      <br>
                      <hr>
                      <div class="container">
                          <div class="divider dividor_color"></div>
                          <div class="form-group">
                              <label for="name" class = "regular_color font_family">${lang.venue_name}:</label><br>
                              <input type="text" id="name" class="form-control" placeholder=${lang.venue_name}: value="${venuedata["name"]}" required>
                          </div>
                          <div class="form-group mb-3">
                              <label for="country" class = "regular_color font_family">${lang.country}:</label><br>
                              <select id="country" name="country" class="form-control" required>                                 
                                  <option value="AFN">Afghanistan</option>
                                  <option value="EUR">Aland Islands</option>
                                  <option value="ALL">Albania</option>
                                  <option value="DZD">Algeria</option>
                                  <option value="USD">American Samoa</option>
                                  <option value="EUR">Andorra</option>
                                  <option value="AOA">Angola</option>
                                  <option value="XCD">Anguilla</option>
                                  <option value="AAD">Antarctica</option>
                                  <option value="XCD">Antigua & Barbuda</option>
                                  <option value="ARS">Argentina</option>
                                  <option value="AMD">Armenia</option>
                                  <option value="AWG">Aruba</option>
                                  <option value="AUD">Australia</option>
                                  <option value="EUR">Austria</option>
                                  <option value="AZN">Azerbaijan</option>
                                  <option value="BSD">Bahamas</option>
                                  <option value="BHD">Bahrain</option>
                                  <option value="BDT">Bangladesh</option>
                                  <option value="BBD">Barbados</option>
                                  <option value="BYN">Belarus</option>
                                  <option value="EUR">Belgium</option>
                                  <option value="BZD">Belize</option>
                                  <option value="XOF">Benin</option>
                                  <option value="BMD">Bermuda</option>
                                  <option value="BTN">Bhutan</option>
                                  <option value="BOB">Bolivia</option>
                                  <option value="USD">Caribbean Netherlands</option>
                                  <option value="BAM">Bosnia & Herzegovina</option>
                                  <option value="BWP">Botswana</option>
                                  <option value="NOK">Bouvet Island</option>
                                  <option value="BRL">Brazil</option>
                                  <option value="USD">British Indian Ocean Territory</option>
                                  <option value="BND">Brunei</option>
                                  <option value="BGN">Bulgaria</option>
                                  <option value="XOF">Burkina Faso</option>
                                  <option value="BIF">Burundi</option>
                                  <option value="KHR">Cambodia</option>
                                  <option value="XAF">Cameroon</option>
                                  <option value="CAD">Canada</option>
                                  <option value="CVE">Cape Verde</option>
                                  <option value="KYD">Cayman Islands</option>
                                  <option value="XAF">Central African Republic</option>
                                  <option value="XAF">Chad</option>
                                  <option value="CLP">Chile</option>
                                  <option value="CNY">China</option>
                                  <option value="AUD">Christmas Island</option>
                                  <option value="AUD">Cocos (Keeling) Islands</option>
                                  <option value="COP">Colombia</option>
                                  <option value="KMF">Comoros</option>
                                  <option value="XAF">Congo - Brazzaville</option>
                                  <option value="CDF">Congo - Kinshasa</option>
                                  <option value="NZD">Cook Islands</option>
                                  <option value="CRC">Costa Rica</option>
                                  <option value="XOF">Côte d’Ivoire</option>
                                  <option value="HRK">Croatia</option>
                                  <option value="CUP">Cuba</option>
                                  <option value="ANG">Curaçao</option>
                                  <option value="EUR">Cyprus</option>
                                  <option value="CZK">Czechia</option>
                                  <option value="DKK">Denmark</option>
                                  <option value="DJF">Djibouti</option>
                                  <option value="XCD">Dominica</option>
                                  <option value="DOP">Dominican Republic</option>
                                  <option value="USD">Ecuador</option>
                                  <option value="EGP">Egypt</option>
                                  <option value="USD">El Salvador</option>
                                  <option value="XAF">Equatorial Guinea</option>
                                  <option value="ERN">Eritrea</option>
                                  <option value="EUR">Estonia</option>
                                  <option value="ETB">Ethiopia</option>
                                  <option value="FKP">Falkland Islands (Islas Malvinas)</option>
                                  <option value="DKK">Faroe Islands</option>
                                  <option value="FJD">Fiji</option>
                                  <option value="EUR">Finland</option>
                                  <option value="EUR">France</option>
                                  <option value="EUR">French Guiana</option>
                                  <option value="XPF">French Polynesia</option>
                                  <option value="EUR">French Southern Territories</option>
                                  <option value="XAF">Gabon</option>
                                  <option value="GMD">Gambia</option>
                                  <option value="GEL">Georgia</option>
                                  <option value="EUR">Germany</option>
                                  <option value="GHS">Ghana</option>
                                  <option value="GIP">Gibraltar</option>
                                  <option value="EUR">Greece</option>
                                  <option value="DKK">Greenland</option>
                                  <option value="XCD">Grenada</option>
                                  <option value="EUR">Guadeloupe</option>
                                  <option value="USD">Guam</option>
                                  <option value="GTQ">Guatemala</option>
                                  <option value="GBP">Guernsey</option>
                                  <option value="GNF">Guinea</option>
                                  <option value="XOF">Guinea-Bissau</option>
                                  <option value="GYD">Guyana</option>
                                  <option value="HTG">Haiti</option>
                                  <option value="AUD">Heard & McDonald Islands</option>
                                  <option value="EUR">Vatican City</option>
                                  <option value="HNL">Honduras</option>
                                  <option value="HKD">Hong Kong</option>
                                  <option value="HUF">Hungary</option>
                                  <option value="ISK">Iceland</option>
                                  <option value="INR">India</option>
                                  <option value="IDR">Indonesia</option>
                                  <option value="IRR">Iran</option>
                                  <option value="IQD">Iraq</option>
                                  <option value="EUR">Ireland</option>
                                  <option value="GBP">Isle of Man</option>
                                  <option value="ILS">Israel</option>
                                  <option value="EUR">Italy</option>
                                  <option value="JMD">Jamaica</option>
                                  <option value="JPY">Japan</option>
                                  <option value="GBP">Jersey</option>
                                  <option value="JOD">Jordan</option>
                                  <option value="KZT">Kazakhstan</option>
                                  <option value="KES">Kenya</option>
                                  <option value="AUD">Kiribati</option>
                                  <option value="KPW">North Korea</option>
                                  <option value="KRW">South Korea</option>
                                  <option value="EUR">Kosovo</option>
                                  <option value="KWD">Kuwait</option>
                                  <option value="KGS">Kyrgyzstan</option>
                                  <option value="LAK">Laos</option>
                                  <option value="EUR">Latvia</option>
                                  <option value="LBP">Lebanon</option>
                                  <option value="LSL">Lesotho</option>
                                  <option value="LRD">Liberia</option>
                                  <option value="LYD">Libya</option>
                                  <option value="CHF">Liechtenstein</option>
                                  <option value="EUR">Lithuania</option>
                                  <option value="EUR">Luxembourg</option>
                                  <option value="MOP">Macao</option>
                                  <option value="MKD">North Macedonia</option>
                                  <option value="MGA">Madagascar</option>
                                  <option value="MWK">Malawi</option>
                                  <option value="MYR">Malaysia</option>
                                  <option value="MVR">Maldives</option>
                                  <option value="XOF">Mali</option>
                                  <option value="EUR">Malta</option>
                                  <option value="USD">Marshall Islands</option>
                                  <option value="EUR">Martinique</option>
                                  <option value="MRO">Mauritania</option>
                                  <option value="MUR">Mauritius</option>
                                  <option value="EUR">Mayotte</option>
                                  <option value="MXN">Mexico</option>
                                  <option value="USD">Micronesia</option>
                                  <option value="MDL">Moldova</option>
                                  <option value="EUR">Monaco</option>
                                  <option value="MNT">Mongolia</option>
                                  <option value="EUR">Montenegro</option>
                                  <option value="XCD">Montserrat</option>
                                  <option value="MAD">Morocco</option>
                                  <option value="MZN">Mozambique</option>
                                  <option value="MMK">Myanmar (Burma)</option>
                                  <option value="NAD">Namibia</option>
                                  <option value="AUD">Nauru</option>
                                  <option value="NPR">Nepal</option>
                                  <option value="EUR">Netherlands</option>
                                  <option value="ANG">Curaçao</option>
                                  <option value="XPF">New Caledonia</option>
                                  <option value="NZD">New Zealand</option>
                                  <option value="NIO">Nicaragua</option>
                                  <option value="XOF">Niger</option>
                                  <option value="NGN">Nigeria</option>
                                  <option value="NZD">Niue</option>
                                  <option value="AUD">Norfolk Island</option>
                                  <option value="USD">Northern Mariana Islands</option>
                                  <option value="NOK">Norway</option>
                                  <option value="OMR">Oman</option>
                                  <option value="PKR">Pakistan</option>
                                  <option value="USD">Palau</option>
                                  <option value="ILS">Palestine</option>
                                  <option value="PAB">Panama</option>
                                  <option value="PGK">Papua New Guinea</option>
                                  <option value="PYG">Paraguay</option>
                                  <option value="PEN">Peru</option>
                                  <option value="PHP">Philippines</option>
                                  <option value="NZD">Pitcairn Islands</option>
                                  <option value="PLN">Poland</option>
                                  <option value="EUR">Portugal</option>
                                  <option value="USD">Puerto Rico</option>
                                  <option value="QAR">Qatar</option>
                                  <option value="EUR">Réunion</option>
                                  <option value="RON">Romania</option>
                                  <option value="RUB">Russia</option>
                                  <option value="RWF">Rwanda</option>
                                  <option value="EUR">St. Barthélemy</option>
                                  <option value="SHP">St. Helena</option>
                                  <option value="XCD">St. Kitts & Nevis</option>
                                  <option value="XCD">St. Lucia</option>
                                  <option value="EUR">St. Martin</option>
                                  <option value="EUR">St. Pierre & Miquelon</option>
                                  <option value="XCD">St. Vincent & Grenadines</option>
                                  <option value="WST">Samoa</option>
                                  <option value="EUR">San Marino</option>
                                  <option value="STD">São Tomé & Príncipe</option>
                                  <option value="SAR">Saudi Arabia</option>
                                  <option value="XOF">Senegal</option>
                                  <option value="RSD">Serbia</option>
                                  <option value="RSD">Serbia</option>
                                  <option value="SCR">Seychelles</option>
                                  <option value="SLL">Sierra Leone</option>
                                  <option value="SGD">Singapore</option>
                                  <option value="ANG">Sint Maarten</option>
                                  <option value="EUR">Slovakia</option>
                                  <option value="EUR">Slovenia</option>
                                  <option value="SBD">Solomon Islands</option>
                                  <option value="SOS">Somalia</option>
                                  <option value="ZAR">South Africa</option>
                                  <option value="GBP">South Georgia & South Sandwich Islands</option>
                                  <option value="SSP">South Sudan</option>
                                  <option value="EUR">Spain</option>
                                  <option value="LKR">Sri Lanka</option>
                                  <option value="SDG">Sudan</option>
                                  <option value="SRD">Suriname</option>
                                  <option value="NOK">Svalbard & Jan Mayen</option>
                                  <option value="SZL">Eswatini</option>
                                  <option value="SEK">Sweden</option>
                                  <option value="CHF">Switzerland</option>
                                  <option value="SYP">Syria</option>
                                  <option value="TWD">Taiwan</option>
                                  <option value="TJS">Tajikistan</option>
                                  <option value="TZS">Tanzania</option>
                                  <option value="THB">Thailand</option>
                                  <option value="USD">Timor-Leste</option>
                                  <option value="XOF">Togo</option>
                                  <option value="NZD">Tokelau</option>
                                  <option value="TOP">Tonga</option>
                                  <option value="TTD">Trinidad & Tobago</option>
                                  <option value="TND">Tunisia</option>
                                  <option value="TRY">Turkey</option>
                                  <option value="TMT">Turkmenistan</option>
                                  <option value="USD">Turks & Caicos Islands</option>
                                  <option value="AUD">Tuvalu</option>
                                  <option value="UGX">Uganda</option>
                                  <option value="UAH">Ukraine</option>
                                  <option value="AED">United Arab Emirates</option>
                                  <option value="GBP">United Kingdom</option>
                                  <option value="USD">United States</option>
                                  <option value="USD">U.S. Outlying Islands</option>
                                  <option value="UYU">Uruguay</option>
                                  <option value="UZS">Uzbekistan</option>
                                  <option value="VUV">Vanuatu</option>
                                  <option value="VEF">Venezuela</option>
                                  <option value="VND">Vietnam</option>
                                  <option value="USD">British Virgin Islands</option>
                                  <option value="USD">U.S. Virgin Islands</option>
                                  <option value="XPF">Wallis & Futuna</option>
                                  <option value="MAD">Western Sahara</option>
                                  <option value="YER">Yemen</option>
                                  <option value="ZMW">Zambia</option>
                                  <option value="ZWL">Zimbabwe</option>
                              </select>
                          </div>
                  
                          <div class="form-group mb-3">
                              <label for="city" class = "regular_color font_family">${lang.city}:</label><br>
                              <input type="text" id="city" class="form-control" placeholder=${lang.city} value="${venuedata["city"]}" required>
                          </div>
                          <div class="form-group mb-3">
                              <label for="address" class = "regular_color font_family">${lang.address}:</label><br>
                              <input type="text" id="address" class="form-control" placeholder=${lang.city} value="${venuedata["address"]}" required>
                          </div>
                          <br>
                          <div class="seats border_color_second">
                              <!--new seat types is added here-->
                          </div>
                          <br>
                          <div class="d-flex align-items-center justify-content-end seat_button">
                              <button id="addnewseattype" class="btn btn-sm button_color font_family d-flex justify-content-center" style="width: 300px;">${lang.add_a_new_type}</button> &nbsp;
                              <button id="removelastseattype" class="btn btn-sm button_color font_family d-flex justify-content-center" style="width: 300px;">${lang.remove_a_new_type}</button>
                          </div>   
                          <div class="d-flex align-items-center justify-content-end">
                              <button type="submit" id="submit" class="btn btn-sm button_color font_family d-flex justify-content-center" style="width: 300px;">${lang.update_venue}</button>
                          </div>               
                      </div>        
                  `;

                // select the country
                let countrySelect = document.getElementById("country");
                let options = countrySelect.options;
                for (let i = 0; i < options.length; i++) {
                  if (options[i].text === venuedata["country"]) {
                    options[i].selected = true;
                    break;
                  }
                }
                // add seat types
                let seatdiv = document.querySelector(".seats");
                let rowCountTotal = 0;
                let typeCounTotal = 0;
                for (let i = 0; i < venuedata["seating"].length; i++) {
                  ++typeCounTotal;
                  // new seat type
                  let newSeatType = document.createElement("div");
                  newSeatType.innerHTML =
                      `<div class="type${typeCounTotal} border_color_second m-4" id="type${typeCounTotal}_seats">
                          <div class="m-3">    
                              <div class="form-group">
                                  <label for="seattype" class="regular_color font_family">${lang.seat_type}:</label>
                                  <input type="text" id="type${typeCounTotal}" class="form-control" placeholder=${lang.seat_type} value="${venuedata["seating"][i]["type"]}" required>
                              </div>                        
                              <div class="type${typeCounTotal}_rows">
                                  <!--new row is added here-->
                              </div>
                          </div>
                       </div>`;
                  seatdiv.appendChild(newSeatType);
                  let seatsrow = document.querySelector(`.type${typeCounTotal}_rows`);
                  for (let j = 0; j < venuedata["seating"][i]["layout"].length; j++) {
                    let anewrow = document.createElement("div");
                    ++rowCountTotal;
                    anewrow.innerHTML = `
                      <div class="form-group">
                              <label for="seatcount" class="regular_color font_family">${lang.row} ${venuedata["seating"][i]["layout"][j]["row_num"]}:</label>
                              <input type="number" name="seatcount" id="row${rowCountTotal}"  value="${venuedata["seating"][i]["layout"][j]["seats_per_row"]}" class="form-control" onchange="checkSeatCount(event)" placeholder=${lang.seat_count} required>
                      </div>`;
                    seatsrow.appendChild(anewrow)
                  }
                  newSeatType.innerHTML += ``;
                  TYPE_COUNT = venuedata["seating"].length;
                  ROW_COUNT = rowCountTotal;

                }
                //add event listener
                const addSeatTypeButton = document.getElementById("addnewseattype");
                const removeSeatTypeButton = document.getElementById("removelastseattype");
                //keep track of new type
                let newTypeCount = 0;

                addSeatTypeButton.addEventListener("click", () => {
                  // ++TYPE_COUNT;
                  if (newTypeCount > 0) {
                    if (checkSeatType() === true && VENUE_GOOD) {
                      lockPrevSeatType(true);
                      ++TYPE_COUNT;
                      ++newTypeCount;
                      const newSeatType = document.createElement("div");
                      newSeatType.innerHTML = `${aSeatType(false)}`;

                      // add seat type to dom
                      seatdiv.appendChild(newSeatType);
                      console.log("total type in if is " + TYPE_COUNT);
                      console.log("total row in if is " + ROW_COUNT);

                      // add row eventlisteners
                      const addrowbutton = document.getElementById(
                          `type${TYPE_COUNT}addnewrow`
                      );
                      const removerowbutton = document.getElementById(
                          `type${TYPE_COUNT}removearow`
                      );
                      const seatsrows = document.querySelector(
                          `.type${TYPE_COUNT}_rows`
                      );

                      addrowbutton.addEventListener("click", () => {
                        const newrow = document.createElement("div");
                        newrow.innerHTML = `${aRow()}`;

                        seatsrows.appendChild(newrow);
                      });
                      addrowbutton.click();

                      removerowbutton.addEventListener("click", () => {
                        const allrows = seatsrows.querySelectorAll(
                            `.type${TYPE_COUNT}_rows > div`
                        );
                        if (allrows.length > 1) {
                          --ROW_COUNT;
                          seatsrows.removeChild(allrows[allrows.length - 1]);
                        }
                      });
                    } else {
                      loadModal("Check all previous input");
                    }
                  } else {
                    ++newTypeCount;
                    ++TYPE_COUNT;
                    const newSeatType = document.createElement("div");
                    newSeatType.innerHTML = `${aSeatType(false)}`;

                    // add seat type to dom
                    seatdiv.appendChild(newSeatType);
                    console.log("total type in else is " + TYPE_COUNT);
                    console.log("total row in else is " + ROW_COUNT);

                    // add row eventlisteners
                    const addrowbutton = document.getElementById(
                        `type${TYPE_COUNT}addnewrow`
                    );
                    const removerowbutton = document.getElementById(
                        `type${TYPE_COUNT}removearow`
                    );
                    const seatsrows = document.querySelector(
                        `.type${TYPE_COUNT}_rows`
                    );

                    addrowbutton.addEventListener("click", () => {
                      const newrow = document.createElement("div");
                      newrow.innerHTML = `${aRow()}`;

                      seatsrows.appendChild(newrow);
                    });
                    addrowbutton.click();

                    removerowbutton.addEventListener("click", () => {
                      const allrows = seatsrows.querySelectorAll(
                          `.type${TYPE_COUNT}_rows > div`
                      );
                      if (allrows.length > 1) {
                        --ROW_COUNT;
                        seatsrows.removeChild(allrows[allrows.length - 1]);
                      }
                    });
                  }

                });

                removeSeatTypeButton.addEventListener("click", () => {
                  console.log("newTypeCount in remove is" + newTypeCount);
                  if (newTypeCount > 0) {
                    const seatTypes = seatdiv.querySelectorAll(".seats > div");
                    console.log("len of div is" + seatTypes.length);
                    --newTypeCount;
                    --TYPE_COUNT;
                    --ROW_COUNT;
                    console.log("after delete type count is" + TYPE_COUNT);
                    lockPrevSeatType(false);
                    seatdiv.removeChild(seatTypes[seatTypes.length - 1]);
                  }
                });


                //handle submission
                const submit = document.getElementById("submit");
                submit.addEventListener("click", () => {
                  event.preventDefault();
                  let _id = venuedata["_id"];
                  let name = document.getElementById("name").value;
                  let countrySelect = document.getElementById("country");
                  let country = countrySelect.options[countrySelect.selectedIndex].text;
                  let city = document.getElementById("city").value;
                  let address = document.getElementById("address").value;

                  if (checkSeatType() && VENUE_GOOD && name !== "" && country !== "" && city !== "" && address !== "") {
                    let seat_count_total = 0;
                    let seating = [];

                    let rowcount = 0;
                    const seatTypes = seatdiv.querySelectorAll(".seats > div");
                    for (let i = 1; i <= seatTypes.length; ++i) {
                      let elem = {};
                      elem.type = document.getElementById(`type${i}`).value;
                      elem.total = 0;
                      elem.layout = [];
                      let rowsForThisType = document.querySelector(`.type${i}_rows`).querySelectorAll(`.type${i}_rows > div`);
                      for (let j = 0; j < rowsForThisType.length; ++j) {
                        ++rowcount;
                        elem.total += parseInt(document.getElementById(`row${rowcount}`).value);
                        let row = {
                          row_num: rowcount,
                          seats_per_row: parseInt(document.getElementById(`row${rowcount}`).value)
                        }

                        elem.layout.push(row);
                      }
                      seat_count_total += elem.total;
                      seating.push(elem);
                    }
                    let venue = {
                      _id: _id,
                      name: name,
                      country: country,
                      city: city,
                      address: address,
                      seat_count_total: seat_count_total,
                      seating: seating,
                    };
                    createLoadingCoverForElement(admin_content);
                    activateLoadingCoverForElement(admin_content);
                    fetch(`/concert/api/updatevenue/`, {
                      method: "POST",
                      headers: {
                        "Content-Type": "application/json",
                      },
                      body: JSON.stringify(venue),
                    })
                        .then((response) => {
                          return response.json();
                        })
                        .then((data) => {
                          disableLoadingCoverForElement(admin_content);
                          if (data["message"] === "venue updated") {
                            document.getElementById("updatevenuetbutton").click();
                            loadModal("Venue updated");
                          } else {
                            document.getElementById("updatevenuetbutton").click();
                            loadModal("Unable to updated venue");
                          }
                        })
                        .catch((error) => {
                          console.log(error);
                        });
                  } else {
                    loadModal("Check all previous input");
                  }
                });
              }


            })
      });

})


document.getElementById("viewvenuebutton").addEventListener("click", () => {
  let lang = translation(dictionary);
  admin_content.innerHTML = `
  <div class="container">
          <div class="divider dividor_color"></div>
              <p  class="detail_list_item regular_color">${lang.enter_vid_view}:</p>
          <div class="form-group mb-3">
              <input type="number" name="concert_view_search" id="venue_view_search" placeholder="1" class="form-control" required>
          </div> 
          <button class="btn button_color font_family" id="venue_search_view_button">${lang.search_button}</button>
          <p style="color: red;" id="global_error_message"></p>
  </div>`;
  document.getElementById("venue_search_view_button").addEventListener("click", () => {
    createLoadingCoverForElement(admin_content);
    activateLoadingCoverForElement(admin_content);
    fetch(`/concert/api/venuebyid/?id=${+document.getElementById("venue_view_search").value}`)
        .then((response) => response.json())
        .then((data) => {
          disableLoadingCoverForElement(admin_content);
          if (data["message"]) {
            document.getElementById("global_error_message").innerText = lang.venue_not_found;
          } else {
            admin_content.innerHTML = `
              <div class = "container">
              <div class="divider dividor_color"></div>
                  <div id="view_data">
                      <p id="id" class="detail_list_item regular_color"> ID: ${data["_id"]}</p>
                      <p id="name" class="detail_list_item regular_color"> ${lang.venue_name}: ${data["name"]}</p>
                      <p id="country" class="detail_list_item regular_color"> ${lang.country}: ${data["country"]}</p>
                      <p id="city" class="detail_list_item regular_color"> ${lang.city}: ${data["city"]}</p>
                      <p id="address" class="detail_list_item regular_color"> ${lang.address}: ${data["address"]}</p>
                      <p id="total" class="detail_list_item regular_color"> ${lang.total_venue_seat_number}: ${data["seat_count_total"]}</p>
                  </div>
              </div>
              `;
            let view_data_div = document.getElementById("view_data");

            for (let i = 0; i < data["seating"].length; ++i) {
              let a_type = document.createElement("div");
              a_type.classList.add("p-3", "border_color_second", "regular_color");
              a_type.innerHTML = `<p class="detail_list_item regular_color">${lang.seat_type}: ${data["seating"][i]["type"]}</p>`;
              a_type.innerHTML += `<p class="detail_list_item regular_color">${lang.total_seat}: ${data["seating"][i]["total"]}</p>`;

              for (let j = 0; j < data["seating"][i]["layout"].length; ++j) {
                a_type.innerHTML += `<p class="detail_list_item regular_color"><u>${lang.row} ${data["seating"][i]["layout"][j]["row_num"]}</u>: ${data["seating"][i]["layout"][j]["seats_per_row"]} ${lang.seats}</p>`;
              }

              view_data_div.appendChild(a_type);
            }
          }

        })
  });

})


document.getElementById("deletevenuebutton").addEventListener("click", () => {
  let lang = translation(dictionary);
  admin_content.innerHTML = `
  <div class="container">
          <div class="divider dividor_color"></div>
              <p  class="detail_list_item regular_color">${lang.enter_vid_delete}</p>
          <div class="form-group mb-3">
              <input type="number" name="concert_view_search" id="venue_view_search" placeholder="1" class="form-control" required>
          </div> 
          <button class="btn button_color font_family" id="venue_search_view_button">${lang.search_button}</button>
          <p style="color: red;" id="global_error_message"></p>
  </div>`;
  document.getElementById("venue_search_view_button").addEventListener("click", () => {
    createLoadingCoverForElement(admin_content);
    activateLoadingCoverForElement(admin_content);
    fetch(`/concert/api/venuebyid/?id=${+document.getElementById("venue_view_search").value}`)
        .then((response) => response.json())
        .then((data) => {
          disableLoadingCoverForElement(admin_content);
          if (data["message"]) {
            document.getElementById("global_error_message").innerText = lang.venue_not_found;
          } else {
            admin_content.innerHTML = `
              <div class = "container">
              <div class="divider dividor_color"></div>
                  <div id="view_data">
                      <p id="id" class="detail_list_item regular_color"> ID: ${data["_id"]}</p>
                      <p id="name" class="detail_list_item regular_color"> ${lang.venue_name}: ${data["name"]}</p>
                      <p id="country" class="detail_list_item regular_color"> ${lang.country}: ${data["country"]}</p>
                      <p id="city" class="detail_list_item regular_color"> ${lang.city}: ${data["city"]}</p>
                      <p id="address" class="detail_list_item regular_color"> ${lang.address}: ${data["address"]}</p>
                      <p id="total" class="detail_list_item regular_color"> ${lang.total_venue_seat_number}: ${data["seat_count_total"]}</p>
                  </div>
              </div>
              `;
            let view_data_div = document.getElementById("view_data");

            for (let i = 0; i < data["seating"].length; ++i) {
              let a_type = document.createElement("div");
              a_type.classList.add("p-3", "border_color_second", "regular_color");
              a_type.innerHTML = `<p class="detail_list_item regular_color">${lang.seat_type}: ${data["seating"][i]["type"]}</p>`;
              a_type.innerHTML += `<p class="detail_list_item regular_color">${lang.total_seat}: ${data["seating"][i]["total"]}</p>`;

              for (let j = 0; j < data["seating"][i]["layout"].length; ++j) {
                a_type.innerHTML += `<p class="detail_list_item regular_color"><u>${lang.row} ${data["seating"][i]["layout"][j]["row_num"]}</u>: ${data["seating"][i]["layout"][j]["seats_per_row"]} seats</p>`;
              }

              view_data_div.appendChild(a_type);
            }
            let centerdiv = document.createElement("div");
            centerdiv.classList.add("d-flex", "align-items-center", "justify-content-center");

            let deleteButton = document.createElement("button");
            deleteButton.classList.add("btn", "button_color", "font_family");
            deleteButton.id = "delete_button";
            deleteButton.innerText = lang.delete_venue;

            centerdiv.appendChild(deleteButton);
            let br = document.createElement("br");
            view_data_div.appendChild(br);
            view_data_div.appendChild(centerdiv);

            document
                .getElementById("delete_button")
                .addEventListener("click", () => {
                  createLoadingCoverForElement(admin_content);
                  activateLoadingCoverForElement(admin_content);
                  fetch(`/concert/api/deletevenue/?id=${data["_id"]}`, {
                    method: "POST",
                    headers: {
                      "Content-Type": "application/json",
                    },
                    body: JSON.stringify(data["_id"]),
                  })
                      .then((response) => response.json())
                      .then((response_data) => {
                        disableLoadingCoverForElement(admin_content);
                        if (response_data["message"] === "Venue Deleted") {
                          document.getElementById("deletevenuebutton").click();
                          loadModal("Venue Deleted");
                        } else {
                          loadModal("Unable to delete venue");
                        }
                      })
                      .catch((err) => {
                        console.log(err);
                      });
                });
          }
        })
  });
})


window.addEventListener("load", () => {
  let lang = translation(dictionary);

  document.getElementById("createconcertbutton").innerText =
      lang.create_concert_button;
  document.getElementById("deleteconcertbutton").innerText =
      lang.delete_concert_button;
  document.getElementById("updateconcertbutton").innerText =
      lang.update_concert_button;
  document.getElementById("viewconcertbutton").innerText =
      lang.view_concert_button;
  document.getElementById("viewrequestsbutton").innerText =
      lang.view_requests_button;

  document.getElementById("createvenuebutton").innerText =
      lang.create_venue;
  document.getElementById("deletevenuebutton").innerText =
      lang.delete_venue;
  document.getElementById("updatevenuebutton").innerText =
      lang.update_venue;
  document.getElementById("viewvenuebutton").innerText =
      lang.view_venue;

  document.getElementById("admin_name").innerText = lang.admin_name;
  document.getElementById("admin_panel").innerText = lang.admin_panel;

  document.getElementById('mod').textContent = lang.close;
});





